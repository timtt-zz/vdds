/*
 *
 * Wijmo Library 2.1.0
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the Wijmo Commercial or GNU GPL Version 3 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/license
 *
 *
 **/
(function(a){"use strict";var d=alert,l=window,xc=document,f=parseInt,uc,pc,wd,c,J,Ad=[],K=null,vc=true,V=true,i=0,A=[],H=null,Zb=null,B="wijeditor-",D="setButtonDisabled",Eb="setButtonsDisabled",t="setButtonChecked",Vc="setButtonsChecked",Cd="form",bd="imagebutton",od="textarea",xd="button",ud="textbox",rd="list",md="passwordfield",Wc="dropdownlist",ad="hiddenfield",zd="radio",kd="checkbox",Jb="insertcol",cc="insertrow",Vb="insertcell",ec="splitcell",N="mergecell",Kb="deletecol",dc="deleterow",Xb="deletecell",bb="justifyleft",W="justifycenter",X="justifyright",ab="justifyfull",qd="borders",T="insertorderedlist",S="insertunorderedlist",sd="outdent",yd="indent",ac="backcolor",bc="fontcolor",nb="bold",hb="italic",kb="strikethrough",cb="underline",x="subscript",u="superscript",hc="template",Lb="removeformat",cd="insertbreak",Mc="insertparagraph",Ic="insertprintpagebreak",ld="inserthorizontalrule",oc="tablebutton",Qb="inserttable",id="edittable",Ub="wysiwyg",fc="split",Yb="code",O="wordwrap",ed="fullscreen",E="undo",I="redo",td="preview",jc="cleanup",wc="cut",qc="copy",nc="paste",jd="selectall",mc="media",Rb="specialchar",Bd="datetime",rc="find",kc="inspect",tc="save",nd="spelling",Ib="imagebrowser",sc="link",eb="xx-small",fb="x-small",mb="small",jb="medium",lb="large",ib="x-large",db="xx-large",s="fontname",y="fontsize",dd="blockquote",Wb="insertcode",b="wijmo-wijribbon",Kc=b+"-bigbutton",pb=b+"-dropdownbutton",de=b+"-splitbutton",of=b+"-list",qf=b+"-save",Ze=b+"-save16",rf=b+"-undo",pf=b+"-redo",Re=b+"-preview",Ne=b+"-cleanup",zf=b+"-cut",kf=b+"-copy",ff=b+"-paste",we=b+"-selectall",Le=b+"-bgcolor",df=b+"-color",jf=b+"-bold",Xe=b+"-italic",ze=b+"-underline",af=b+"-strike",Af=b+"-sub",Bf=b+"-sup",Ge=b+"-template",Sd=b+"-removeformat",be=b+"-justifyleft",Ld=b+"-justifycenter",Rd=b+"-justifyright",ae=b+"-justifyfull",Me=b+"-borders",ve=b+"-orderlist",ee=b+"-unorderlist",Qe=b+"-outdent",We=b+"-indent",Oe=b+"-inspect",lf=b+"-find",Zc=b+"-table",Fc=b+"-inserttable",Lc=b+"-edittable",se=b+"-insertcol",te=b+"-insertrow",ke=b+"-insertcell",xe=b+"-splitcell",ue=b+"-mergecell",qe=b+"-deletecol",re=b+"-deleterow",he=b+"-deletecell",Zd=b+"-insertbreak",Hd=b+"-insertparagraph",Dd=b+"-insertprintpagebreak",Ee=b+"-inserthr",mf=b+"-form",He=b+"-textarea",Se=b+"-textbox",Fe=b+"-password",Xd=b+"-hiddenfield",Yd=b+"-imagebutton",Ve=b+"-button",Pe=b+"-listbox",Pd=b+"-dropdownlist",gf=b+"-radio",Ce=b+"-checkbox",nf=b+"-link",Ye=b+"-link16",Qd=b+"-imagebrowser",ef=b+"-media",ce=b+"-specialchar",De=b+"-datetime",ge=b+"-blockquote",le=b+"-insertcode",Yc=b+"-modes",ie=b+"-designview",me=b+"-sourceview",ye=b+"-splitview",Ie=b+"-wordwrap",je=b+"-fullscreen",e="wijmo-wijeditor",pe=e+"-container",Tc=e+"-header",Rc=e+"-content",G=e+"-footer",Cc=e+"-pathselector",Gc=e+"-fullscreen",ob=e+"-dialog",Gf=ob+"-hr",v=ob+"-buttons",m=ob+"-button",h=ob+"-text",k=e+"-imagedlg",Je=k+"-content",Te=k+"-fields",Mb=k+"-imagefield",hf=k+"-imagelist",Ke=k+"-preview",Z=k+"-imagesrc",fd=k+"-imagealt",Nb=k+"-imagewidth",Fb=k+"-imageheight",gd=k+"-css",vb=k+"-hideimagelist",g=e+"-templatedlg",Df=g+"-toplabels",vf=g+"-topleftlabel",xf=g+"-toprightlabel",tf=g+"-content",Ef=g+"-templatelist",uf=g+"-preview",wf=g+"-templateinfo",Pb=g+"-nameinfo",Tb=g+"-descriptioninfo",Cf=g+"-fields",M=g+"-name",U=g+"-description",sf=g+"-buttons",hd=g+"-delete",pd=g+"-save",z=e+"-linkdlg",L=z+"-address",Jc=z+"-linktype",Cb=z+"-anchor",Ob=z+"-text",R=z+"-target",Sb=z+"-css",vd=e+"-codedlg",Qc=vd+"-source",Od=vd+"-sourcelabel",r=e+"-taginsdlg",oe=r+"-caption",fe=r+"-taglabel",Hc=r+"-tagtext",Kd=r+"-filterempty",ne=r+"-attribs",Q=r+"-attriblist",ub=r+"-innerhtml",Hb=r+"-css",ic=e+"-colordlg",zb=ic+"-picker",C=ic+"-color",o=e+"-tabledlg",Gb=o+"-rows",xb=o+"-columns",Db=o+"-width",Bb=o+"-height",Ab=o+"-border",sb=o+"-cellpadding",tb=o+"-cellspacing",yb=o+"-csstext",F=o+"-bgcolor",n=e+"-previewdlg",Wd=n+"-caption",qb=n+"-navigator",Pc=n+"-prev",Oc=n+"-next",Dc=n+"-printall",Ec=n+"-printone",Uc=n+"-ok",yc=n+"-printdocument",Gd=n+"-previewiframe",Y=e+"-cleanupdlg",Vd=Y+"-caption",Nd=Y+"-document",Ud=Y+"-actions",lc=e+"-finddlg",cf=lc+"-find",Be=lc+"-replace",P=e+"-mediadlg",Ue=P+"-type",Xc=P+"-src",Sc=P+"-width",Nc=P+"-height",q=e+"-specialchardlg",Md=q+"-chars",Id=q+"-preview",zc=q+"-content",Td=q+"-list",rb=q+"_label",Ed=q+"-punctuation",Jd=q+"-symbols",Fd=q+"-diacritics",w="wijmo-formatspan",j="."+v+" input:first",p="."+v+" input:last",bf="."+v+" input[value='OK']",wb="."+v+" input[value='Cancel']",yf=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],Bc=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],Ac=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],Ae={Form:{name:"form",tip:"Form",css:mf},Image:{name:"imagebutton",tip:"Image Button",css:Yd},TextArea:{name:"textarea",tip:"TextArea",css:He},Button:{name:"button",tip:"Button",css:Ve},TextBox:{name:"textbox",tip:"TextBox",css:Se},List:{name:"list",tip:"ListBox",css:Pe},PasswordField:{name:"passwordfield",tip:"Password Field",css:Fe},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Pd},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Xd},Radio:{name:"radio",tip:"RadioButton",css:gf},CheckBox:{name:"checkbox",tip:"CheckBox",css:Ce},InsertColumn:{name:"insertcol",tip:"Insert Column",css:se},InsertRow:{name:"insertrow",tip:"Insert Row",css:te},InsertCell:{name:"insertcell",tip:"Insert Cell",css:ke},SplitCell:{name:"splitcell",tip:"Split Cell",css:xe},MergeCell:{name:"mergecell",tip:"Merge Cell",css:ue},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:qe},DeleteRow:{name:"deleterow",tip:"Delete Row",css:re},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:he},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:be,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:Ld,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:Rd,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:ae,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:Me},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:ve,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:ee,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:Qe,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:We,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:Le},ForeColor:{name:"fontcolor",tip:"Font Color",css:df},Bold:{name:"bold",tip:"Bold",css:jf},Italic:{name:"italic",tip:"Italic",css:Xe},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:af},UnderLine:{name:"underline",tip:"Underline",css:ze},SubScript:{name:"subscript",tip:"Subscript",css:Af},SuperScript:{name:"superscript",tip:"Superscript",css:Bf},Template:{name:"template",tip:"Template",css:Ge},RemoveFormat:{name:"removeformat",tip:"RemoveFormat",css:Sd},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:Zd},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Hd},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:Dd},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:Ee},Table:{name:"tablebutton",tip:"Table",css:Zc},InsertTable:{name:"inserttable",tip:"Insert Table",css:Fc},EditTable:{name:"edittable",tip:"Edit Table",css:Lc},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:ie,grpname:"modes"},Split:{name:"split",tip:"Split View",css:ye,grpname:"modes"},Code:{name:"code",tip:"Source View",css:me,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:Ie},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:je},Undo:{name:"undo",tip:"Undo",css:rf},Redo:{name:"redo",tip:"Redo",css:pf},Preview:{name:"preview",tip:"Preview",css:Re},Cleanup:{name:"cleanup",tip:"Clean up",css:Ne},Cut:{name:"cut",tip:"Cut",css:zf},Copy:{name:"copy",tip:"Copy",css:kf},Paste:{name:"paste",tip:"Paste",css:ff},SelectAll:{name:"selectall",tip:"Select All",css:we},Media:{name:"media",tip:"Media",css:ef},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:ce},InsertDate:{name:"datetime",tip:"Insert Date Time",css:De},Find:{name:"find",tip:"Find And Replace",css:lf,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:Oe,text:"Inspect"},Save:{name:"save",tip:"Form",css:qf,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:Qd},Link:{name:"link",tip:"Link",css:nf,text:"Link"},FontName:{name:"fontname",tip:"Font Name",css:pb},FontSize:{name:"fontsize",tip:"Font Size",css:pb},BlockQuote:{name:"blockquote",tip:"Block Quote",css:ge},InsertCode:{name:"insertcode",tip:"Insert Code",css:le}},gc=function(){var a=this,b=[];a.append=function(a){b.push(a)};a.toString=function(){return b.join("")};a.dispose=function(){b=null}},Ff=function(a){this.text=a;this.render=function(){return this.text}},gb=function(f,c,d){var b=this,e={br:true,img:true,hr:true,input:true};b.tagName=f||"div";b.attributes=d||{};b.innerText=c||"";b.children=[];if(a.isPlainObject(c)){b.innerText="";b.attributes=c}b._isShortTag=false;if(e[b.tagName]===true)b._isShortTag=true;b.render=function(){var c=new gc,d="";c.append(b._renderBeginTag(b.tagName,b.attributes));b.innerText!==""&&c.append(b.innerText);b.children.length>0&&a.each(b.children,function(b,a){c.append(a.render())});c.append(b._renderEndTag(b.tagName));d=c.toString();c.dispose();return d};b.add=function(a){this.children.push(a)};b._renderBeginTag=function(e,d){var b=new gc,c="";b.append("<");b.append(e);a.each(d,function(c,a){b.append(" ");b.append(c);b.append("=");b.append('"');b.append(a.toString());b.append('"')});if(this._isShortTag)b.append(" ");else b.append(">");c=b.toString();b.dispose();return c};b._renderEndTag=function(c){var a=new gc,b="";if(this._isShortTag)a.append("/>");else{a.append("</");a.append(c);a.append(">")}b=a.toString();a.dispose();return b}};a.widget("wijmo.wijeditor",{options:{fullScreenContainerSelector:"",editorMode:"wysiwyg",fullScreenMode:false,showPathSelector:true,mode:"ribbon",commandButtonClick:null,simpleModeCommands:null,showFooter:true,customContextMenu:true},_create:function(){var a=this;if(a.element.is("input"))return;a._editorify();a._initElements();l.setTimeout(function(){a.options.disabled&&a._handleDisabledOption(true,a.editor)},40);a._continueSavingInputTextForUndo=false},_createBigButton:function(f,e,c,d){var b=this,a=b._createElement("button",{title:f,name:c,"class":Kc});a.add(b._createDiv(e));a.add(b._createSpan("",d));return a},_createTextButton:function(c,a,b){return this._createElement("button",b,{title:c,name:a})},_createButton:function(f,e,c,d){var b=this,a;if(!d)return b._createElement("button",{title:f,name:c,"class":e});a=b._createElement("button",{title:f,name:c});a.add(b._createSpan(e));a.add(b._createSpan("",d));return a},_createTextRadioButton:function(g,c,b,e,f){var d=this,a=[];a.push(d._createElement("input",{id:c+b,type:"radio",name:e}));a.push(d._createElement("label",f,{"for":c+b,title:g,name:b}));return a},_createImageRadioButton:function(g,c,f,b,e){var d=this,a=[];a.push(d._createElement("input",{id:c+b,type:"radio",name:e}));a.push(d._createElement("label",{"for":c+b,title:g,name:b,"class":f}));return a},_createImageCheckButton:function(f,c,e,b){var d=this,a=[];a.push(d._createElement("input",{id:c+b,type:"checkbox"}));a.push(d._createElement("label",{"for":c+b,title:f,name:b,"class":e}));return a},_createRibbonList:function(){return this._createSpan(of)},_createDropdownButton:function(f,e,i,h,g){var b=this,c=b._createElement("div",{title:f,"class":pb}),d=b._createElement("ul");c.add(b._createTextButton(f,e,i));c.add(d);a.each(h,function(i,c){var f=b._createElement("li"),h=b._createTextRadioButton(c.tip,g,c.name,e,c.text);a.each(h,function(b,a){f.add(a)});d.add(f)});return c},_createSplitButton:function(e,i,g,h,f){var b=this,c=b._createElement("div",{title:e,"class":de}),d=b._createElement("ul");c.add(b._createBigButton(e,i,g,h));c.add(b._createElement("button",{"class":Kc}));c.add(d);a.each(f,function(e,a){var c=b._createElement("li");c.add(b._createButton(a.tip,a.css,a.name,a.text));d.add(c)});return c},_createButtonByCommand:function(e){var b=this,c,a=Ae[e],d;if(!a)return;d=a.name;switch(d){case dd:case Cd:case bd:case od:case xd:case ud:case rd:case md:case Wc:case ad:case zd:case kd:case Jb:case cc:case Vb:case ec:case N:case Kb:case dc:case Xb:case Lb:case cd:case Mc:case Ic:case ed:case E:case I:case wc:case qc:case nc:case Bd:case O:case ac:case bc:case td:case jc:case mc:case Rb:case hc:case Ib:case Wb:case ld:case jd:c=b._createButton(a.tip,a.css,d);break;case rc:case kc:c=b._createButton(a.tip,a.css,d,a.text);break;case qd:case x:case u:case nb:case hb:case cb:case kb:c=b._createImageCheckButton(a.tip,B,a.css,d);break;case Ub:case fc:case Yb:case bb:case W:case X:case ab:case sd:case yd:case T:case S:c=b._createImageRadioButton(a.tip,B,a.css,d,a.grpname);break;case oc:c=b._createSplitButton("Table",Zc,oc,"Table",[{tip:"Insert Table",css:Fc,name:Qb,text:"Insert"},{tip:"Edit Table",css:Lc,name:id,text:"Edit"}]);break;case tc:if(b.options.mode==="ribbon")c=b._createBigButton(a.tip,a.css,d,a.text);else c=b._createButton(a.tip,Ze,d);break;case sc:if(b.options.mode==="ribbon")c=b._createBigButton(a.tip,a.css,d,a.text);else c=b._createButton(a.tip,Ye,d);break;case s:c=b._createDropdownButton("Font Name",s,"Font Name",[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],B);break;case y:c=b._createDropdownButton("Font Size",y,"Font Size",[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],B)}return c},_createActionGroup:function(){var a=this,c=a._createElement("li"),b=a._createRibbonList();c.add(a._createButtonByCommand("Save"));c.add(b);b.add(a._createButtonByCommand("Undo"));b.add(a._createButtonByCommand("Redo"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("Preview"));b.add(a._createButtonByCommand("Cleanup"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("Cut"));b.add(a._createButtonByCommand("Copy"));b.add(a._createButtonByCommand("Paste"));b.add(a._createButtonByCommand("SelectAll"));c.add(a._createElement("div","Actions"));return c},_createFontGroup:function(){var b=this,d=b._createElement("li"),c=b._createRibbonList();d.add(b._createButtonByCommand("FontName"));d.add(b._createButtonByCommand("FontSize"));d.add(c);c.add(b._createButtonByCommand("BackColor"));c.add(b._createButtonByCommand("ForeColor"));c=b._createRibbonList();d.add(c);a.each(b._createButtonByCommand("Bold"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("Italic"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("UnderLine"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("StrikeThrough"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("SubScript"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("SuperScript"),function(b,a){c.add(a)});c=b._createRibbonList();d.add(c);c.add(b._createButtonByCommand("Template"));c=b._createRibbonList();d.add(c);c.add(b._createButtonByCommand("RemoveFormat"));d.add(b._createElement("div","Font"));return d},_createParaGroup:function(){var c=this,d=c._createElement("li"),b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("JustifyLeft"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("JustifyCenter"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("JustifyRight"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("JustifyFull"),function(c,a){b.add(a)});b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("Border"),function(c,a){b.add(a)});b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("NumberedList"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("BulletedList"),function(c,a){b.add(a)});b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("Outdent"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("Indent"),function(c,a){b.add(a)});d.add(c._createElement("div","Paragraph"));return d},_createReviewGroup:function(){var b=this,a=b._createElement("li");a.add(b._createButtonByCommand("Inspect"));a.add(b._createButtonByCommand("Find"));a.add(b._createElement("div","Review"));return a},_createTablesGroup:function(){var a=this,c=a._createElement("li"),b=a._createRibbonList();c.add(a._createButtonByCommand("Table"));c.add(b);b.add(a._createButtonByCommand("InsertColumn"));b.add(a._createButtonByCommand("InsertRow"));b.add(a._createButtonByCommand("InsertCell"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("SplitCell"));b.add(a._createButtonByCommand("MergeCell"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("DeleteColumn"));b.add(a._createButtonByCommand("DeleteRow"));b.add(a._createButtonByCommand("DeleteCell"));c.add(a._createElement("div","Tables"));return c},_createBreaksGroup:function(){var b=this,a=b._createElement("li");a.add(b._createButtonByCommand("InsertBreak"));a.add(b._createButtonByCommand("InsertParagraph"));a.add(b._createButtonByCommand("InsertPrint"));a.add(b._createButtonByCommand("InsertHR"));a.add(b._createElement("div","Breaks"));return a},_createFormsGroup:function(){var b=this,c=b._createElement("li"),a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("Form"));a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("TextArea"));a.add(b._createButtonByCommand("TextBox"));a.add(b._createButtonByCommand("PasswordField"));a.add(b._createButtonByCommand("HiddenField"));a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("Image"));a.add(b._createButtonByCommand("Button"));a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("List"));a.add(b._createButtonByCommand("DropDownList"));a.add(b._createButtonByCommand("Radio"));a.add(b._createButtonByCommand("CheckBox"));c.add(b._createElement("div","Forms"));return c},_createSpecialGroup:function(){var b=this,a=b._createElement("li");a.add(b._createButtonByCommand("Link"));a.add(b._createButtonByCommand("InsertImage"));a.add(b._createButtonByCommand("Media"));a.add(b._createButtonByCommand("InsertSpecialChar"));a.add(b._createButtonByCommand("InsertDate"));a.add(b._createElement("div","Special"));return a},_getDefaultRibbonMarkup:function(){var a=this,d=a._createElement("div"),e=a._createElement("ul"),g=a._createElement("li"),i=a._createElement("li"),f=a._createElement("div",{id:B+"format"}),h=a._createElement("div",{id:B+"insert"}),b=a._createElement("ul"),c=a._createElement("ul");d.add(e);d.add(f);d.add(h);e.add(g);e.add(i);g.add(a._createElement("a","Format",{href:"#"+B+"format"}));i.add(a._createElement("a","Insert",{href:"#"+B+"insert"}));f.add(b);b.add(a._createActionGroup());b.add(a._createFontGroup());b.add(a._createParaGroup());b.add(a._createReviewGroup());h.add(c);c.add(a._createTablesGroup());c.add(a._createBreaksGroup());c.add(a._createFormsGroup());c.add(a._createSpecialGroup());return d.render()},_getRibbonModesMarkup:function(){var b=this,d=b._createDiv(Yc),c=b._createRibbonList();d.add(c);a.each(b._createButtonByCommand("Wysiwyg"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("Code"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("Split"),function(b,a){c.add(a)});d.add(b._createButtonByCommand("Wordwrap"));d.add(b._createButtonByCommand("FullScreen"));return d.render()},_getSimpleToolBar:function(e){var d=this,b,c=d._createDiv("");a.each(e,function(f,e){b=d._createButtonByCommand(e);if(b)if(a.inArray(e,yf)!==-1)a.each(b,function(b,a){c.add(a)});else c.add(b)});return c.render()},_editorify:function(){var b=this,d=b.element,p=d.width(),o=d.height(),f=b.options,m=f.mode,g,j,l,k,i,h,n;b._oriStyle=d.attr("style");b._oriContent=d.html();if(d.is("textarea")){if(m==="ribbon")c=a(b._getDefaultRibbonMarkup());else if(m==="bbcode")c=a(b._getSimpleToolBar(Ac));else if(f.simpleModeCommands&&f.simpleModeCommands.length!==0){l=a.grep(f.simpleModeCommands,function(a){return a!=="Table"});c=a(b._getSimpleToolBar(l))}else c=a(b._getSimpleToolBar(Bc));b.sourceView=d;b.editor=d.wrap("<div></div>").parent();b.editor.width(p).height(o)}else{b.editor=d;c=d.children(":eq(0)");h=d.children(":eq(1)");if(h.is("textarea"))b.sourceView=h;else{n=h.html();h.remove();b.sourceView=a("<textarea></textarea>").val(n)}}g=a("<div class='"+pe+"'></div>");b.dialog=a("<div class ='"+e+"'></div>");b.subDialog=a("<div class ='"+e+"'></div>");b.editor.addClass(e).append(g).append(b.dialog).append(b.subDialog);b._createMenuMarkUp(b,f);c.wrap("<a href='#'></a>").parent().appendTo("<div class='"+Tc+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(g);j=a("<div class='"+Rc+"'></div>").appendTo(g);b.designView=a("<iframe frameborder='0'></iframe>");b.designView.wrap("<div></div>").parent().appendTo(j);b.sourceView.wrap("<div></div>").parent().appendTo(j);k=[c];J=a(b._getRibbonModesMarkup());if(f.showFooter){i=a("<div class='"+G+" ui-widget ui-widget-content ui-state-default'></div>");g.append(i);i.append("<div class='"+Cc+"'></div>");J.appendTo(i);k.push(J)}a.each(k,function(c,a){a.wijribbon({click:function(c,a){b._ribbonCommand(a.commandName,a.name);b._trigger("commandButtonClick",c,a)}})})},_createMenuMarkUp:function(b,c){if(c.customContextMenu&&!a.browser.webkit){b.contextMenu=a("<ul><li _c1buttoncmd='cut'><a>Cut</a></li><li _c1buttoncmd='copy'><a>Copy</a></li><li _c1buttoncmd='paste'><a>Paste</a></li></ul>");a("<a href='#'></a>").append(b.contextMenu).appendTo(b.editor)}},_handleDisabledOption:function(b,c){var a=this;if(b){if(!a.disabledDiv)a.disabledDiv=a._createDisabledDiv(c);a.disabledDiv.appendTo("body")}else if(a.disabledDiv){a.disabledDiv.remove();a.disabledDiv=null}},_createDisabledDiv:function(d){var g=this,b=d?d:g.element,c=b.offset(),f=b.outerWidth(),e=b.outerHeight();return a("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"absolute","background-color":"lightgray",width:f,height:e,left:c.left,top:c.top})},_initElements:function(){var a=this,b=a.options,e=a.element.height()-a._getHeader().outerHeight(true)-a._getFooter().outerHeight(true),d={};a._getContent().height(e).wijsplitter({showExpander:false,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:false},panel2:{scrollBars:"none",collapsed:true}});a._addHandlerToDesignView();a._addDefaultFontStyleToDesignView();a._createWijMenu();(!b.showPathSelector||a.options.mode==="bbcode")&&a._getPathSelector().hide();a._ribbonCommand(b.editorMode);b.fullScreenMode&&a._setFullScreen(b.fullScreenMode);d[I]=true;d[E]=true;c.wijribbon(Eb,d)},_setOption:function(e,d){var b=this,f=b.options,i=f.mode,h=c.parent(),g=f.customContextMenu;a.Widget.prototype._setOption.apply(b,arguments);if(e==="fullScreenMode"){f.fullScreenMode=d;b._setFullScreen(d)}else if(e==="showPathSelector"){f.showPathSelector=d;if(d)b._getPathSelector().show();else b._getPathSelector().hide()}else if(e==="editorMode"){f.editorMode=d;b._ribbonCommand(d)}else if(e==="fullScreenContainerSelector"){f.fullScreenContainerSelector=d;b.options.fullScreenMode&&b._setFullScreen(true)}else if(e==="disabled")b._handleDisabledOption(d,b.editor);else if(e==="showFooter")if(d)!a("."+G).is(":visible")&&a("."+G).show();else a("."+G).is(":visible")&&a("."+G).hide();else if(e==="commandButtonClick")f.commandButtonClick=d;else if(e==="customContextMenu"){if(g===d)return;if(d){!b.contextMenu&&b._createMenuMarkUp(b,f);b._createWijMenu()}else{b.contextMenu.wijmenu("destroy").remove();b.contextMenu=undefined}}else if(e==="mode"&&d!==i){c.wijribbon("destroy");c.remove();if(d==="ribbon")c=a(b._getDefaultRibbonMarkup());else if(d==="bbcode")c=a(b._getSimpleToolBar(Ac));else c=a(b._getSimpleToolBar(Bc));h.append(c);c.wijribbon({click:function(c,a){b._ribbonCommand(a.commandName,a.name);b._trigger("commandButtonClick",c,a)}})}},_getHeader:function(){return a("."+Tc,this.editor)},_getContent:function(){return a("."+Rc,this.editor)},_getFooter:function(){return a("."+G,this.editor)},_getPathSelector:function(){return a("."+Cc,this.editor)},_getModes:function(){return a("."+Yc,this.editor)},_getDesignView:function(){return this.designView},_getDesignViewWindow:function(){var a=this.designView;return a&&a.length>0?a[0].contentWindow:null},_getDesignViewDocument:function(){var a=this._getDesignViewWindow();return a?a.document:null},_getDesignViewText:function(){var a=this._getDesignViewDocument();return a&&a.body&&a.body.innerHTML?a.body.innerHTML:""},_setDesignViewText:function(a){var c=this,b=this._getDesignViewDocument();if(this.options.mode==="bbcode")a=c._convertBBCodeToHtml(a);if(b&&b.body)b.body.innerHTML=a},_getDialog:function(){return this.dialog},_getSubDialog:function(){return this.subDialog},_initContentDocument:function(){var b=this,c=b.sourceView.val(),d=b._getDesignViewDocument();if(b.options.mode==="bbcode")c=b._convertBBCodeToHtml(a.trim(c));d.open();d.write('<html style="width:100%;height:100%;'+(b.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle"  type="text/css" >table,td,tr{border: 1px #acacac dashed;}</style></head><body>'+c+"</body></html>");d.close();A=[];A.push(c);i=0},_addHandlerToDesignView:function(){var b=this,d=b._getDesignViewWindow(),c=d.document;b._initContentDocument();if(a.browser.mozilla)setTimeout(b._setDesignModeForFF,1e3,b);else b._setContentEditable(c,true);b.sourceView.bind("blur."+b.widgetName,function(){b._onSourceViewBlur()});b.sourceView.bind("keyup."+b.widgetName,function(){b._onSourceViewBlur()});if(!a.browser.mozilla)a(d).blur(function(){b._onDesignViewBlur()});else a(c).bind("blur."+b.widgetName,function(){b._onDesignViewBlur()});a(c).bind("mouseup."+b.widgetName,function(a){b._onDesignViewMouseUp(a)}).bind("keydown."+b.widgetName,function(a){b._onDesignViewKeyDown(a)}).bind("keyup."+b.widgetName,function(a){b._onDesignViewKeyUp(a);b._onDesignViewBlur()})},_addDefaultFontStyleToDesignView:function(){var e=this,f=e.options,g=e._getDesignViewDocument(),b=f.defaultFontName,d=f.defaultFontSize,c='<style type="text/css"> body {';if((b===""||b===null)&&(d===""||d===null))return;if(b!==""&&b!==null)c+="font-family: "+b+";";if(f.defaultFontSize!==""&&f.defaultFontSize!==null)c+=" font-size: "+d+";";c+="}</style>";window.setTimeout(function(){a(c).appendTo(a("head",g))},200);e._setFontStyleButtonState(b,s);e._setFontStyleButtonState(d,y)},_setFontStyleButtonState:function(b,e){var d="";if(!b||b===null)return;a.each(c.wijribbon("getDropdownList",e),function(c,a){if(a.toUpperCase()===b.toUpperCase()){d=c;return false}});c.wijribbon(t,d,true,e)},_setDesignModeForFF:function(a){a._getDesignViewDocument().designMode="on"},destroy:function(){var b=this;b.element.html(b._oriContent);b.element.removeAttr("tabindex");if(b._oriStyle===undefined)b.element.removeAttr("style");else b.element.attr("style",b._oriStyle);b.element.insertBefore(b.editor);b.element.unbind("."+b.widgetName);b.editor.remove();a.Widget.prototype.destroy.call(b)},showEditorDialog:function(a){switch(a){case Qb:case hc:case Ib:case kc:case rc:case Rb:case mc:case jc:case sc:case ac:case bc:case Wb:this._ribbonCommand(a);break;default:d("Cannot find the dialog with command name '"+a+"'!")}},executeEditorAction:function(b,a){this._ribbonCommand(b,a)},_isFontSizeCustomized:function(){if(K!==null)return K;var b=c.wijribbon("getDropdownList",y),d=[eb,fb,mb,jb,lb,ib,db];K=false;a.each(b,function(b){if(a.inArray(b,d)===-1){K=true;return false}});return K},_fontSizeCommand:function(e){var c=this,d=c._getDesignViewDocument(),b=4,f="font-size",g=[];switch(e){case eb:b=1;break;case fb:b=2;break;case mb:b=3;break;case jb:b=4;break;case lb:b=5;break;case ib:b=6;break;case db:b=7}if(!c._isFontSizeCustomized())d.execCommand("FontSize",false,b);else if(a.browser.msie)c._formatFontSpan(d,f,e);else{d.execCommand("FontSize",false,b);a.each(a("font[size]",d),function(d,b){g.push(c._replaceFontWithSpan(a(b),"size",f,e))});c._setSelection(g)}c.options.mode==="bbcode"&&!a.browser.msie&&c._convertFontStyleToStandTag();c._addtoUndoBuffer()},_fontNameCommand:function(g){var b=this,e=b._getDesignViewDocument(),f=c.wijribbon("getDropdownList",s),d;a.each(f,function(b,a){if(g===b){d=a;return false}});e.execCommand("FontName",false,d);b._isFontSizeCustomized()&&a.browser.msie&&b._formatFontSpan(e,"font-family",d);b._addtoUndoBuffer()},_formatFontSpan:function(h,b,f){var c=this,e=f,d="fontFamily",g=[];if(b!=="font-family"){e="c1-temp";d="fontSize"}h.execCommand("FontName",false,e);a.each(a("font[face='"+e+"']",h),function(k,j){var i=c._replaceFontWithSpan(a(j),"face",b,f),h,e;g.push(i);h=a("span."+w,i);for(e=h.length-1;e>=0;e--)c._removeSpecifiedStyleSpan(a(h[e]),d,b);a.each(i,function(f,e){a.each(a(e).parents("span."+w),function(h,g){var f=a(g);if(f.children().length>1)return false;f.text()===a(e).text()&&c._removeSpecifiedStyleSpan(f,d,b)})})});c._setSelection(g)},_setSelection:function(c,k,j){var i=this._getDesignViewWindow(),g=i.document,b,f,e,d,h=0;try{if(a.browser.msie){b=g.selection.createRange();if(c){a.each(c,function(b,a){h+=a.text().length});b.moveToElementText(c[0][0]);b.collapse(true);b.moveEnd("character",h)}else{b.moveStart("textedit",-1);b.collapse(true);b.moveStart("character",k);b.moveEnd("character",j)}b.select()}else{d=i.getSelection();b=g.createRange();f=c[0][0];e=c[c.length-1][0];b.setStart(f,0);b.setEnd(e,e.childNodes.length);d.removeAllRanges();d.addRange(b)}}catch(l){}},_replaceFontWithSpan:function(a,c,e,d){a.wrap("<span class = '"+w+"' style='"+e+":"+d+"'></span>");var b=a.parent();a.removeAttr(c);if(/<font\s*>/ig.test(b.html())){b.html(a.html());a.remove()}return b},_removeSpecifiedStyleSpan:function(b,f,e){var c,d=true;b[0].style[f]!==""&&b.css(e,"");c=b.attr("style");c&&a.each(c.split(";"),function(f,c){var b=a.trim(c).toLowerCase();if(b!==""&&b.indexOf(e)!==-1){d=false;return false}});d&&b.replaceWith(b.html())},_removeFormat:function(){var d=this,e=d._getDesignViewDocument(),b={};e.execCommand(Lb,false,null);d._isFontSizeCustomized()&&a.browser.msie&&d._removeFormatForIE(e);d._addtoUndoBuffer();b[nb]=false;b[hb]=false;b[kb]=false;b[cb]=false;b[x]=false;b[u]=false;b[T]=false;b[S]=false;b[bb]=false;b[W]=false;b[X]=false;b[ab]=false;c.wijribbon(Vc,b)},_removeFormatForIE:function(g){var i=g.selection.createRange(),k=i.htmlText,s=i.text,p=0,r=a(i.parentElement()),m=a(g.body),o="",l="",h="__c1temp",j="c1-temp",q="<span class='"+j+"'>"+h+"</span>",b,f,e,d,c,n;r.addClass("c1-app-parent");i.pasteHTML(q);p=m.text().indexOf(h);b=a("span."+j,g);f=b;b.parentsUntil("body").each(function(){if(a(this).is(".c1-app-parent"))return false;f=a(this)});b.html(k);e=a("span."+w,b);for(c=e.length-1;c>=0;c--){d=a(e[c]);d.replaceWith(d.html())}!f.is("."+j)&&f.after(b);a.each(f.parents("span."+w),function(c,b){o+="</span>";l="<span class='"+w+"' style = '"+a(b).attr("style")+"'>"+l});k=b.html();b.replaceWith(h);n=m.html().split(h);m.html(n[0]+o+k+l+n[1]);e=a("span."+w,g);for(c=e.length-1;c>=0;c--){d=a(e[c]);d.text()===""&&d.replaceWith(d.html())}a(".c1-app-parent",g).removeClass("c1-app-parent");this._setSelection(null,p,s.length)},_toggleFullScreen:function(){var b=this,a=b.options;a.fullScreenMode=!a.fullScreenMode;b._setFullScreen(a.fullScreenMode)},_setFullScreen:function(k){var b=this,m=1,p=b._getHeader(),o=b._getFooter(),n=b._getContent(),e=b.options.fullScreenContainerSelector,d=a(e),j=b._getDesignViewText(),h,g,i;if(k){if(d.length===0){d=a(l);e="body";b._oriDocOverFlow=a(document.documentElement).css("overflow");a(document.documentElement).css({overflow:"hidden"});!a.browser.mozilla&&window.scrollTo(0,0);a(l).bind("resize.wijeditor",function(){b._fullscreenOnWindowResize()})}h=d.width();g=d.height()-2*m;uc=b.editor.width();pc=b.editor.height();if(!wd)wd=b.editor.parent();if(!b._replacedDiv)b._replacedDiv=a("<div />");b.editor.after(b._replacedDiv);a(e).append(b.editor);b.editor.css({width:h,height:g,position:""}).addClass(Gc);b.sourceView.css({width:h,height:g});c.wijribbon("updateRibbonSize")}else{b._replacedDiv.after(b.editor).remove();b.editor.css({width:uc,height:pc,position:"static"}).removeClass(Gc);b.sourceView.css({width:uc,height:pc});!b.options.fullScreenContainerSelector&&a(document.documentElement).css({overflow:b._oriDocOverFlow});a(l).unbind("resize.wijeditor");c.wijribbon("updateRibbonSize")}i=b.editor.height()-p.outerHeight(true)-o.outerHeight(true);n.height(i).wijsplitter("refresh");b._addHandlerToDesignView();b._addDefaultFontStyleToDesignView();b._createWijMenu();a.browser.msie&&window.setTimeout(function(){b._setDesignViewText(j);f(a.browser.version)>=9&&b.sourceView.val(j)},40)},_createWijMenu:function(){var b=this,c=b._getDesignViewDocument();b.contextMenu&&b.contextMenu.wijmenu({orientation:"vertical",trigger:b.designView,triggerEvent:"rtclick",showing:function(j,d){if(a.browser.msie)H=c.selection.createRange();d.show();var e=b.designView.offset(),f=a(a(b.designView)[0].contentWindow).scrollLeft(),g=a(a(b.designView)[0].contentWindow).scrollTop(),h=e.left+2-f,i=e.top-g;d.position({my:"left top",at:"right top",of:j,offset:h+" "+i,collision:"none none"});d.hide()},animation:{animated:"fade"},select:function(c,a){b._setIESelection();b._contextMenuItemClick(c,a)}})},_fullscreenOnWindowResize:function(){var b=this,h=b._getHeader(),f=b._getFooter(),d=b._getContent(),c,g=a(window).width(),e=a(window).height();b.editor.css({width:g,height:e});c=b.editor.height()-h.height()-f.height();d.height(c).wijsplitter("refresh")},_saveText:function(){},_doSpellCheck:function(){},_ribbonCommand:function(h,j){var b=this,e=b._getDesignViewDocument(),i=b._getContent(),d,g,f;if(j===s){b._fontNameCommand(h);b._onDesignViewBlur();return}if(j===y){b._fontSizeCommand(h);b._onDesignViewBlur();return}b._setIEFocus();switch(h){case dd:if(a.browser.msie){e.execCommand("FormatBlock",false,"<ADDRESS>");f=e.selection.createRange();f=a(f.parentElement()).closest("address");if(f.length){f.replaceWith("<blockquote>"+f.html()+"</blockquote>");e.body.innerHTML=e.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>");e.body.innerHTML=e.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>");e.body.innerHTML=e.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"")}}else e.execCommand("FormatBlock",false,"<BLOCKQUOTE>");break;case Cd:d=b._generateUniqueName("form");b.insertHTML('<form id="'+d+'" name="'+d+'" method="post">'+d+"</form>");break;case bd:d=b._generateUniqueName("image");b.insertHTML('<input id="'+d+'" name="'+d+'" type="image" value="'+d+'"/>');break;case od:d=b._generateUniqueName("textarea");b.insertHTML('<textarea id="'+d+'" name="'+d+'" rows="4" cols="48"></textarea>');break;case xd:d=b._generateUniqueName("button");b.insertHTML('<input id="'+d+'" name="'+d+'" type="button" value="'+d+'"/>');break;case ud:d=b._generateUniqueName("textbox");b.insertHTML('<input id="'+d+'" name="'+d+'" type="text" value="'+d+'"/>');break;case rd:d=b._generateUniqueName("list");b.insertHTML('<select id="'+d+'" name="'+d+'" style="width: 120px" size="8"></select>');break;case md:d=b._generateUniqueName("password");b.insertHTML('<input id="'+d+'" name="'+d+'" type="password" value="'+d+'"/>');break;case Wc:d=b._generateUniqueName("dropdown");b.insertHTML('<select id="'+d+'" name="'+d+'"></select>');break;case ad:d=b._generateUniqueName("hidden");b.insertHTML('<input id="'+d+'" name="'+d+'" type="hidden" value="'+d+'" />');break;case zd:d=b._generateUniqueName("radiobox");b.insertHTML('<input id="'+d+'" name="'+d+'" type="radio" value="'+d+'"><label for="'+d+'">'+d+"</label></input>");break;case kd:d=b._generateUniqueName("checkbox");b.insertHTML('<input id="'+d+'" name="'+d+'" type="checkbox" value="'+d+'"><label for="'+d+'">'+d+"</label></input>");break;case Jb:case cc:case Vb:case ec:case N:case Kb:case dc:case Xb:b._tableAction(h);break;case qd:b._toggleTableBorders();break;case x:try{if(e.queryCommandState(u)){e.execCommand(u,false,null);c.wijribbon(t,u,false)}}catch(l){}e.execCommand(x,false,null);b._addtoUndoBuffer();break;case u:try{if(e.queryCommandState(x)){e.execCommand(x,false,null);c.wijribbon(t,x,false)}}catch(k){}e.execCommand(u,false,null);b._addtoUndoBuffer();break;case Lb:b._removeFormat();break;case cd:b.insertHTML("<br/>");break;case Mc:g=b._getSelectedContent();if(!g||g==="")g="&nbsp;";b.insertHTML("<p>"+g+"</p>");break;case Ic:b.insertHTML('<div title="Print Page Break" style="font-size:1px;page-break-before:always;vertical-align:middle;height:1px;background-color:#c0c0c0">&nbsp;</div>');break;case ed:b._toggleFullScreen();break;case E:b._undoAction();break;case I:b._redoAction();break;case wc:b._execCut();break;case qc:b._execCopy();break;case nc:b._execPaste();break;case Bd:b.insertDateAndTime();break;case Ub:J.wijribbon(D,O,true).wijribbon(t,Ub,true);c.wijribbon("option","disabled",false);i.wijsplitter("option","panel2",{collapsed:true});break;case fc:J.wijribbon(D,O,true).wijribbon(t,fc,true);c.wijribbon("option","disabled",false);i.wijsplitter("option",{panel1:{collapsed:false},panel2:{collapsed:false}});break;case Yb:J.wijribbon(D,O,false).wijribbon(t,Yb,true);c.wijribbon("option","disabled",true);i.wijsplitter("option","panel1",{collapsed:true});break;case O:i.wijsplitter("option","panel1").collapsed&&b._toggleWordWrap();break;case ac:b._saveSelectionForIE();b._createDialog("Set BackColor",b._getDialogRes_BackColor(),b.initBackColorDialog);break;case bc:b._saveSelectionForIE();b._createDialog("Set ForeColor",b._getDialogRes_ForeColor(),b.initForeColorDialog);break;case Qb:b._saveSelectionForIE();b._createDialog("Insert Table",b._getDialogRes_Table(false),b.initInsertTableDialog);break;case id:b._getEditableTable()&&b._createDialog("Edit Table",b._getDialogRes_Table(true),b.initEditTableDialog);break;case td:b._createDialog("Preview",b._getDialogRes_Preview(),b.initPreviewDialog);break;case jc:b._createDialog("Clean up source HTML document",b._getDialogRes_CleanUp(),b.initCleanUpDialog);break;case mc:b._saveSelectionForIE();b._createDialog("Insert media",b._getDialogRes_Media(),b.initMediaDialog);break;case Rb:b._saveSelectionForIE();b._createDialog("Insert special character",b._getDialogRes_SpecialCharacter(),b.initSpecialCharacterDialog);break;case rc:b._createDialog("Find and replace",b._getDialogRes_FindAndReplace(),b.initFindDialog);break;case kc:Zb=b._getSelectedElement();b._createDialog("Tag Inspector",b._getDialogRes_TagInspector(),b.initTagInspectorDialog);break;case hc:b._saveSelectionForIE();b._createDialog("Apply Template",b._getDialogRes_Template(),b.initTemplateDialog);break;case Ib:b._saveSelectionForIE();b._createDialog("Image Browser",b._getDialogRes_ImageBrowser(),b.initImageBrowserDialog);break;case sc:b._saveSelectionForIE();b._createDialog("Insert hyperLink",b._getDialogRes_Link(),b.initHyperLinkDialog);break;case Wb:b._saveSelectionForIE();b._createDialog("Insert Code",b._getDialogRes_Code(),b.initInsertCodeDialog);break;case bb:case W:case X:case ab:case sd:case yd:case nb:case hb:case cb:case T:case S:case kb:case ld:case jd:e.execCommand(h,false,null);b.options.mode==="bbcode"&&!a.browser.msie&&b._convertStyleToStandTag();b._addtoUndoBuffer();break;case tc:b._saveText();break;case nd:b._doSpellCheck()}b._onDesignViewBlur()},_saveSelectionForIE:function(){var c=this._getDesignViewWindow(),b;if(a.browser.msie){b=c.document.selection;H=b.createRange()}},_createDialog:function(d,e,c){var a=this,b=a.dialog;b.html("").undelegate(a.widgetName).undelegate("."+a.widgetName).append(e);a.subDialog&&a.subDialog.html("").undelegate(a.widgetName).undelegate("."+a.widgetName);if(!b.data("wijdialog"))b.wijdialog({width:"auto",height:"auto",modal:true,title:d,position:"center",resizable:false,captionButtons:{pin:{visible:false},refresh:{visible:false},toggle:{visible:false},minimize:{visible:false},maximize:{visible:false}}});else{b.wijdialog("reset");b.wijdialog("option",{width:"auto",height:"auto",title:d})}a._adjustDialogLayoutForIE7();c&&c.call(a);b.wijdialog("open")},_adjustDialogLayoutForIE7:function(){var b=this.dialog;a.browser.msie&&/^7\.[0-9]+/.test(a.browser.version)&&b.wijdialog("option","width",b.parent().width())},_contextMenuItemClick:function(e,b){var a=this,c=b.item.attr("_c1buttoncmd");switch(c){case wc:a._execCut();break;case qc:a._execCopy();break;case nc:a.focus();a._execPaste()}},_execCut:function(){var b=this,c=b._getDesignViewDocument();if(a.browser.safari)d("This function is not supported in current browser. Plesse use (Ctrl + X).");else if(a.browser.msie){c.execCommand("Cut",false,null);b._addtoUndoBuffer()}else{b._execCopy();b._deleteSelectionContent();b._addtoUndoBuffer()}},_execCopy:function(){var b=this,c=b._getDesignViewDocument();if(a.browser.safari)d("This function is not supported in current browser. Plesse use (Ctrl + C).");else if(a.browser.msie){c.execCommand("Copy",false,null);b._addtoUndoBuffer()}else b._copyToClipboard(b._getSelectedContent())},_execPaste:function(){var c=this,b,e=c._getDesignViewDocument();if(a.browser.safari)d("This function is not supported in current browser. Plesse use (Ctrl + V).");else if(a.browser.msie){e.execCommand("Paste",false,null);c._addtoUndoBuffer()}else try{b=c._copyFromClipboard();b&&b!==""&&c.insertHTML(b)}catch(f){}},_getFontSizeCollection:function(){return{"10px":eb,"13px":fb,"16px":mb,"18px":jb,"24px":lb,"32px":ib,"48px":db,1:eb,2:fb,3:mb,4:jb,5:lb,6:ib,7:db}},_updateButtonStates:function(l){var e=this,k=e._getDesignViewDocument(),d,b,h={},j=[nb,hb,kb,cb,x,u,T,S,bb,W,X,ab],g,i=l.target,f=a(i);a.each(j,function(b,a){h[a]=k.queryCommandState(a)});c.wijribbon(Vc,h);d=e._queryCommandValue(s)||"";a.each(c.wijribbon("getDropdownList",s),function(c,a){if(a.toUpperCase()===d.toUpperCase()){b=c;return false}});c.wijribbon(t,b,true,s);if(e._isFontSizeCustomized()){if(f.is("span"))b=i.style.fontSize;else b="";if(b===""){g=f.parents("span."+w);a.each(g,function(c,a){b=a.style.fontSize;if(b&&b!=="")return false})}if(b==="")b=f.css("font-size")}else{d=e._queryCommandValue(y)||"";if(d==="")d=f.css("font-size");a.each(e._getFontSizeCollection(),function(c,a){if(c.toString()===d.toString()){b=a;return false}})}c.wijribbon(t,b,true,y)},_queryCommandValue:function(a){var b=this._getDesignViewDocument();try{if(!b.queryCommandEnabled(a))return null}catch(c){return null}try{return b.queryCommandValue(a)}catch(d){}return null},_escActionAssociated:function(){var b=this,a=b._getDesignViewWindow();a.document.selection!==undefined&&a.document.selection.empty();a.getSelection!==undefined&&a.getSelection().removeAllRanges();b._hideAllDropdownsMenus()},_hideAllDropdownsMenus:function(){var a=this;a.contextMenu&&a.contextMenu.wijmenu("hideAllMenus");c.wijribbon("hideDropdown",s).wijribbon("hideDropdown",y).wijribbon("hideDropdown",oc)},_onDesignViewKeyDown:function(b){var a=this,c;a._setSaveBtnEnabled();try{if(b.ctrlKey)c=String.fromCharCode(b.keyCode).toLowerCase();else switch(b.keyCode){case 27:a._escActionAssociated();break;case 13:case 46:a._addtoUndoBuffer();a._continueSavingInputTextForUndo=false;break;default:a._continueSavingInputTextForUndo=true}}catch(d){}},_onDesignViewKeyUp:function(a){var b=this,c;(a.keyCode===37||a.keyCode===38||a.keyCode===39||a.keyCode===40||a.keyCode===33||a.keyCode===34||a.keyCode===35||a.keyCode===36)&&b._updateButtonStates(a);if(a.ctrlKey){c=String.fromCharCode(a.keyCode).toLowerCase();switch(c){case"y":b._redoAction();a.preventDefault();a.stopPropagation();break;case"z":b._undoAction();a.preventDefault();a.stopPropagation();break;case"x":case"v":b._addtoUndoBuffer();b._continueSavingInputTextForUndo=false}}},_onDesignViewMouseUp:function(c){var d=this,b;if(c.button===2)return;d._updateButtonStates(c);d._refreshPathSelector();d._hideAllDropdownsMenus();a(document).mouseup();if(a.browser.msie){b=a(c.target).closest("a");if(c.ctrlKey&&b.length>0)try{b.focus();l.open(b[0].href,"_blank")}catch(e){}}},_onDesignViewBlur:function(){var b=this,d=b.options,c;c=b._getDesignViewText();b._onTextChange();if(d.mode==="bbcode")c=b._convertHtmlToBBCode(a.trim(c));b.sourceView.val(c)},_onTextChange:function(){var a=this;if(a._continueSavingInputTextForUndo){a._addtoUndoBuffer();a._continueSavingInputTextForUndo=false}},_onSourceViewBlur:function(){var b=this,a;a=b.sourceView.val();b._setDesignViewText(a)},_convertBBCodeToHtml:function(a){a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/(?:\r\n|\n|\r)/g,"<br>");a=a.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>');a=a.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>');a=a.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>');a=a.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>');a=a.replace(/\[B\]/gim,"<b>");a=a.replace(/\[\/B\]/gim,"</b>");a=a.replace(/\[I\]/gim,"<i>");a=a.replace(/\[\/I\]/gim,"</i>");a=a.replace(/\[S\]/gim,"<strike>");a=a.replace(/\[\/S\]/gim,"</strike>");a=a.replace(/\[U\]/gim,"<u>");a=a.replace(/\[\/U\]/gim,"</u>");a=a.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>');a=a.replace(/\[BLOCK\]/gim,"<blockquote>");a=a.replace(/\[\/BLOCK\]/gim,"</blockquote>");a=a.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>");a=a.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>");a=a.replace(/\[\*\]/gim,"</li><li>");a=a.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">');a=a.replace(/\[\/size\]/gim,"</font>");a=a.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">');a=a.replace(/\[\/color\]/gim,"</font>");return a},_replaceComplexHtml:function(g){var f,c,d,b,e=a("<div/>").html(g);f=a("img",e);a.each(f,function(){d="[IMG height="+a(this).height()+" width="+a(this).width()+"]"+a(this).attr("src").toString()+"[/IMG]";a(this).replaceWith(d)});c=a("font",e);for(b=c.length-1;b>=0;b--){if(a(c[b]).attr("color")&&a(a(c[b])).attr("size"))d="[Color="+a(a(c[b])).attr("color")+"][Size="+a(a(c[b])).attr("size")+"]"+a(a(c[b])).html()+"[/Size][/Color]";else if(a(a(c[b])).attr("color")&&!a(a(c[b])).attr("size"))d="[Color="+a(a(c[b])).attr("color")+"] "+a(a(c[b])).html()+"[/Color]";else if(a(a(c[b])).attr("size")&&!a(a(c[b])).attr("color"))d="[Size="+a(a(c[b])).attr("size")+"]"+a(a(c[b])).html()+"[/Size]";a(a(c[b])).replaceWith(d)}return e.html()},_convertHtmlToBBCode:function(a){var b=this;if(a==="")return;a=b._replaceComplexHtml(a);a=a.replace(/<br(?=[ \/>]).*?>/gim,"\r\n");a=a.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]");a=a.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]");a=a.replace(/<(?:b|strong)>/gim,"[B]");a=a.replace(/<\/(?:b|strong)>/gim,"[/B]");a=a.replace(/<(?:i|em)>/gim,"[I]");a=a.replace(/<\/(?:i|em)>/gim,"[/I]");a=a.replace(/<(?:strike|s)>/gim,"[S]");a=a.replace(/<\/(?:strike|s)>/gim,"[/S]");a=a.replace(/<u>/gim,"[U]");a=a.replace(/<\/u>/gim,"[/U]");a=a.replace(/<blockquote.*?\>/gim,"[BLOCK]");a=a.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]");a=a.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]");a=a.replace(/<\/(?:ol)>/gim,"[/LIST]");a=a.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]");a=a.replace(/<\/(?:ul)>/gim,"[/LIST]");a=a.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1");a=a.replace(/&nbsp;/gi," ");a=a.replace(/(<[^>]+>)/gm,"");return a},_convertFontStyleToStandTag:function(){var e=this,g=e._getDesignViewDocument(),f=a(g.body),b,c,d=a("[style*='color: ']",f);if(d.length!==0){b=d;c="<font color='"+e._getWebColorFromRgb(d.css("color"))+"'></font>"}b&&a.each(b,function(){if(a(this).is("span"))a(this).replaceWith(a(c).html(a(this).html()));else a(this).is("font")&&a(this).attr("size")&&a(this).removeAttr("style").html(a(c).html(a(this).html()))})},_convertStyleToStandTag:function(){var j=this,k=j._getDesignViewDocument(),d=a(k.body),b,c,e,i=a("[style*='font-weight: bold;']",d),g=a("[style*='font-style: italic;']",d),h=a("[style*='text-decoration: line-through;']",d),f=a("[style*='text-decoration: underline;']",d);if(i.length!==0){b=i;c="<b></b>";e="font-weight"}else if(g.length!==0){b=g;c="<i></i>";e="font-style"}else if(h.length!==0){b=h;c="<strike></strikes>";e="text-decoration"}else if(f.length!==0){b=f;c="<u></u>";e="text-decoration"}b&&a.each(b,function(){if(a(this).is("span")&&this.style.fontSize==="")a(this).replaceWith(a(c).html(a(this).html()));else a(this).removeAttr("style").html(a(c).html(a(this).html()))})},_getWebColorFromRgb:function(a){var c=this,b;if(a.indexOf("rgb(")===0){b=a.substring(4,a.length-1).split(",");a=c._convertToWebColor(f(b[0]),f(b[1]),f(b[2]))}return a},_updateList:function(d,c){var b;a("option",c).remove();for(b in d)d[b]&&c.append("<option>"+b+"</option>")},_triggerEvent:function(c,d){var b=this,a=b.options[c];return a&&typeof a==="function"?a.call(b,d):a},_closeDialog:function(){this.dialog.wijdialog("close")},_onTemplateList:function(a){return this._triggerEvent("templateList",a)},updateTemplateList:function(c,e){var b=this,d=e||a("select",b.dialog);b._updateList(c,d);b._templateList=c},initTemplateDialog:function(){var b=this,d=b.dialog,e=a("select",d),c=b._onTemplateList();d.delegate("select","change."+b.widgetName,function(){b.templateListOnChanged()}).delegate("."+hd,"click."+b.widgetName,function(){b.deleteTemplate()}).delegate("."+pd,"click."+b.widgetName,function(){b.saveTemplate()}).delegate(j,"click."+b.widgetName,function(){b.applyTemplate()}).delegate(p,"click."+b.widgetName,function(){b._closeDialog()});if(!c){c=b._templateList;if(!c)return}b.updateTemplateList(c,e)},templateListOnChanged:function(){var g=this,c=g.dialog,d=a("select",c).val(),e=a("iframe",c),f=g._templateList,b;if(!f)return;b=f[d];b.src&&e.attr("src",b.src+"?d="+(new Date).getMilliseconds().toString());b.text&&e.length>0&&e[0].contentWindow.document.write(b.text);if(d){a("."+Pb,c).html(d);a("."+M,c).val(d)}if(b.desc){a("."+Tb,c).html(b.desc);a("."+U,c).val(b.desc)}},_onSaveTemplate:function(a){this._triggerEvent("saveTemplate",a)},saveTemplate:function(){var c=this,f=c.dialog,b=a("."+M,f).val(),g=a("."+U,f).val(),e=c._templateList,h=this._getDesignViewText();if(a.trim(b)===""){d("Please input a template name!");return}if(!e){c._templateList=[];e=c._templateList}!e[b]&&a("select",f).append("<option>"+b+"</option>");e[b]={desc:g,text:h};c._onSaveTemplate({name:b,desc:g,text:h})},_onDeleteTemplate:function(a){this._triggerEvent("deleteTemplate",a)},deleteTemplate:function(){var e=this,b=e.dialog,f=a("select",b),c=f.val(),g=e._templateList;if(a.trim(c)===""){d("Please select a template file.");return}a("option:selected",f).remove();a("iframe",b).attr("src","about:blank");a("."+Pb,b).empty();a("."+M,b).val("");a("."+Tb,b).empty();a("."+U,b).val("");delete g[c];e._onDeleteTemplate(c)},applyTemplate:function(){var b=this,c=b.dialog,g=a("select",c),e=g.val(),f=a("iframe",c)[0],i=a("."+M,c).val(),h=f.contentWindow.document.body.innerHTML;if(a.trim(i)===""||a.trim(e)===""){d("Please select a valid template file.");return}b._setDesignViewText(h);b._addtoUndoBuffer();b._setSaveBtnEnabled();b._closeDialog()},_onImageList:function(){var b=this,a=b.options.imageList;return a&&typeof a==="function"?a.call(b):a},updateImageList:function(b,g){var c=this,e=c.dialog,f=g||a("select",e),d=a("."+Mb,e);c._updateList(b,f);c._imgList=b;if(!b){d.addClass(vb);return}d.removeClass(vb)},initImageBrowserDialog:function(){var b=this,d=b.dialog,c=b._onImageList();a("img",d).hide();d.delegate("select","change."+b.widgetName,function(){b.imageListOnChanged(this)}).delegate("."+Z+" input","change."+b.widgetName,function(){b.imageUrlChanged(this)}).delegate(j,"click."+b.widgetName,function(){b.submitInsertImageDialog();b._onDesignViewBlur()}).delegate(p,"click."+b.widgetName,function(){b._closeDialog()});if(!c){c=b._imgList;if(!c){a("."+Mb,d).addClass(vb);return}}b.updateImageList(c,a("select",d))},imageUrlChanged:function(b){a("img",this.dialog).attr("src",a(b).val()).show()},imageListOnChanged:function(){var e=this,b=e.dialog,f=a("select",b).val(),d=e._imgList,c;if(!d)return;c=d[f];a("img",b).attr("src",c).show();a("."+Z+" input",b).attr("value",c);l.setTimeout(function(){a("."+Nb+" input",b).val(a("img",b).width());a("."+Fb+" input",b).val(a("img",b).height())},200)},submitInsertImageDialog:function(){var b=this,e,c=b.dialog,g=a("."+Z+" input",c).val(),i=a("."+fd+" input",c).val(),h=a("."+Nb+" input",c).val(),f=a("."+Fb+" input",c).val(),j=a("."+gd+" input",c).val();if(a.trim(g)===""){d("Please select a image.");return}if(!b._isNumeric(h)){d("Please input a number for 'Image width' textbox.");return}if(!b._isNumeric(f)){d("Please input a number for 'Image height' textbox.");return}b.focus();e='<img src="'+g+'" alt="'+i+'" width="'+h+'" height="'+f;if(b.options.mode!=="bbcode")e+='" style="'+j;e+='"/>';b.insertHTML(e);b._closeDialog()},initHyperLinkDialog:function(){var b=this,c=b.dialog,d=b.getLinkHrefField(),e=a("."+L+" input",c);c.delegate(j,"click."+b.widgetName,function(){b.submitHyperLinkDialog();b._onDesignViewBlur()}).delegate(p,"click."+b.widgetName,function(){b._closeDialog()}).delegate("."+Cb,"change."+b.widgetName,function(){b.anchorListOnChanged(this)}).delegate("."+Jc+">div","click."+b.widgetName,function(){b.radioListOnChanged()});try{e.val(d);a("."+Ob+" input",c).val(b._getLinkInnerHTML());a("."+Sb+" input",c).val(b._getLinkCssField());a("."+R+" select",c).val(b._getLinkTarget())}catch(f){}a("#radAnchor",c).attr("checked","checked");if(d.length>6)if(d.substring(0,4)==="http")a("#radUrl",c).attr("checked","checked");else if(d.substring(0,6)==="mailto")a("#radMail",c).attr("checked","checked");else if(d.substring(0,1)==="#")a("#radAnchor",c).attr("checked","checked");else a("#radFile",c).attr("checked","checked")},_getLinkInnerHTML:function(){var b=this,a;b.focus();a=b._getInspectElement();return a&&a.tagName==="A"?a.innerHTML||"":b.getSelectionHTMLContent()||""},getLinkHrefField:function(){var b=this,a;b.focus();a=b._getInspectElement();try{if(a&&a.tagName==="A")return b.fixAbsoluteUrlsIfNeeded(a.href||"")}catch(c){}return""},_getLinkTarget:function(){var b=this,a;b.focus();a=b._getInspectElement();return a&&a.tagName==="A"?a.target||"":""},_getLinkCssField:function(){var b=this,a;b.focus();a=b._getInspectElement();return a&&a.tagName==="A"?a.style.cssText||"":""},submitHyperLinkDialog:function(){var c=this,b=c.dialog,h=a("#radMail",b),g=a("."+L+" input",b),k=a("."+Ob+" input",b),l=a("."+Sb+" input",b),i=a("."+R+" select",b),e=g.val(),f=k.val(),j=i.val(),m=l.val();if(e===""){d("Please input address!");return}if(f===""){d("Please input display text!");return}if(h.attr("checked")&&!c._isEmail(e)){d("Please input correct email!");return}c._editLink(f,e,m,j);c._closeDialog()},_editLink:function(g,f,d,e){var b=this,a,c="";b.focus();a=b._getInspectElement();if(a&&a.tagName==="A"){a.innerHTML=g;a.href=f;a.target=e;if(d!==a.style.cssText)a.style.cssText=d;b._addtoUndoBuffer();b._setSaveBtnEnabled();return}c='<a href="'+f+'" target="'+e+'"';if(d!=="")c+=' style="'+d+'"';c+=">"+g+"</a>";b._setIESelection();b.insertHTML(c)},anchorListOnChanged:function(d){var e=this,b=e.dialog,c=a(d).val();if(c!==""){a("."+L+" input",b).val(c);a("#radAnchor",b).attr("checked","checked")}},radioListOnChanged:function(){var e=this,b=e.dialog,c=a("."+Cb,b),d=a("."+L+" input",b);d.val("");if(a("#radUrl",b).is(":checked"))c.hide();else if(a("#radAnchor",b).is(":checked"))c.show();else if(a("#radMail",b).is(":checked")){c.hide();d.val("mailto:")}else a("#radFile",b).is(":checked")&&c.hide()},_getDialogRes_Code:function(){var b=this,a=b._createDiv(z);a.add(b._createElement("div","Enter source code",{"class":Od}));a.add(b._createElement("textarea","",{"class":Qc}));a.add(b._createSeparator());a.add(b._createOKCancelButtons());return a.render()},initInsertCodeDialog:function(){var a=this,b=a.dialog;b.delegate(j,"click."+a.widgetName,function(){a.submitCodeDialog();a._onDesignViewBlur()}).delegate(p,"click."+a.widgetName,function(){a._closeDialog()})},submitCodeDialog:function(){var c=this,e=c.dialog,d=a("."+Qc,e),b=d.val();if(b==="")return;b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");b="<pre>"+b+"</pre>";c._setIESelection();c.insertHTML(b);c._closeDialog()},initTagInspectorDialog:function(){var b=this,c=b.dialog,d=a("."+ub);c.delegate(j,"click."+b.widgetName,function(){b.submitTagInspectorDialog();b._onDesignViewBlur()}).delegate(p,"click."+b.widgetName,function(){b._closeDialog()}).delegate("#displayNoEmpty","click."+b.widgetName,function(){b.tagInspectorDialogSwitchAttList(this)});b._laySelectedElementAttributes(a("."+Q,c),a("."+Hc,c));a("."+Hb+" input",c).val(b._getSelectedElementStyle());if(b._selectedElementCanHaveChildren()){d.show();a("textarea",d).val(b._getSelectedElementInnerHTML())}else d.hide()},submitTagInspectorDialog:function(){var b=this,g=b.dialog,c=b._getInspectElement(),e=a("."+Q,g),d=a("."+Hb+" input").val(),f=a("."+ub+" textarea").val();try{a.each(a("input:checkbox",e),function(g,f){var b,e,d=a(f);if(d.is(":checked")){b=d.siblings("span").text();b=b.substring(0,b.length-1);e=d.siblings("input:text").val();a(c).attr(b,e)}});if(a.trim(d)!=="")c.style.cssText=d;b._selectedElementCanHaveChildren()&&a(c).html(f)}catch(h){}b._closeDialog();b._addtoUndoBuffer();b._setSaveBtnEnabled()},tagInspectorDialogSwitchAttList:function(c){var b=a("."+Q,this.dialog),d=!c.checked;a.each(a("input:text",b),function(c,b){a(b).val()===""&&a(b).parent("li")[d?"show":"hide"]()})},_laySelectedElementAttributes:function(i,j){var f=this,c=f._getInspectElement(),g,d,e,b="";if(!c)return;j.html(c.tagName);g=f._getDictionaryDeclare();d=c.tagName.toLowerCase();e=g[d];switch(d){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":b+="<ul class='ui-helper-reset'>";a.each(e,function(d,a){var e=c.getAttribute(a)||"";b+="<li><span class='"+h+"'>";b+=a+":</span>";b+="<input type='text' value='"+e+"'/>";b+="<input type='checkbox' id='save"+d+"'/>";b+="<label for='save"+d+"'>Save</label></li>"})}i.html(b)},_getSelectedElementStyle:function(){var a=this._getInspectElement();return a&&a.style?a.style.cssText||"":""},_getSelectedElementInnerHTML:function(){var a=this._getInspectElement();return a?a.innerHTML:""},_selectedElementCanHaveChildren:function(){return!a(this._getInspectElement()).is("input,hr,br,img")},initBackColorDialog:function(){this._initColorDialog("BackColor")},initForeColorDialog:function(){this._initColorDialog("ForeColor")},_initColorDialog:function(h){var c=this,g=c.dialog,k=c._getDesignViewDocument(),i=k.queryCommandValue(h),e,d,b;g.delegate(j,"click."+c.widgetName,function(){c.submitColorDialog(h);c._onDesignViewBlur()}).delegate(p,"click."+c.widgetName,function(){c._closeDialog()});if(i){b=i.toString();if(a.browser.msie){e=f(b);b="rgb("+(e&255)+", "+((e&65280)>>8)+", "+((e&16711680)>>16)+")"}if(b.indexOf("rgb(")===0){d=b.substring(4,b.length-1).split(",");b=c._convertToWebColor(f(d[0]),f(d[1]),f(d[2]))}else if(b.indexOf("rgba(")===0){d=b.substring(5,b.length-1).split(",");b=c._convertToWebColor(f(d[0]),f(d[1]),f(d[2]))}a("."+C+" input",g).attr("value",b)}a("."+zb,g).wijeditorcolorcanvas("."+C+" input",b)},submitColorDialog:function(c){var b=this,d=a("."+C+" input",b.dialog);b.setColor(c,d.val());b._closeDialog()},setColor:function(d,e){var b=this,f=b._getDesignViewDocument(),g=b._getDesignViewWindow(),c;b._setIESelection();if(a.browser.mozilla&&d==="BackColor"){c=g.getSelection();b.insertHTML('<span style="background-color:'+e+';">'+c+"</span>")}else{f.execCommand(d,false,e);b.options.mode==="bbcode"&&!a.browser.msie&&b._convertFontStyleToStandTag()}b._addtoUndoBuffer();b._setSaveBtnEnabled()},initInsertTableDialog:function(){var a=this,b=a.dialog;b.delegate(j,"click."+a.widgetName,function(){a.submitInsertTableDialog();a._onDesignViewBlur()}).delegate(wb,"click."+a.widgetName,function(){a._closeDialog()}).delegate("."+F+" input:button","click."+a.widgetName,function(){a.showTableColorDialog(this)})},submitInsertTableDialog:function(){var a=this,b=a._getValuesFromTableDialog();if(!b)return;a._insertTable(b);a._closeDialog()},_insertTable:function(b){var g=this,c="",d,e;if(!b)return false;g._setIEFocus();c+='<table width="'+b.width+'" height="'+b.height+'" cellspacing="'+b.cspacing+'" cellpadding="'+b.cpadding+'" border="'+b.border+'" bgcolor="'+b.bgcolor+'" style="'+b.css+'">';for(d=0;d<b.rows;d++){c+="<tr>";for(e=0;e<b.cols;e++)c+="<td>Cell "+(d+1)+"-"+(e+1)+"</td>";c+="</tr>"}c+="</table>";if(a.browser.mozilla||a.browser.msie&&f(a.browser.version)>=9)c+="<br />";g.insertHTML(c)},initEditTableDialog:function(){var c=this,b=c.dialog,d=c._getInspectElement(),e,f;b.delegate(j,"click."+c.widgetName,function(){c.submitEditTableDialog();c._onDesignViewBlur()}).delegate(wb,"click."+c.widgetName,function(){c._closeDialog()}).delegate("."+F+" input:button","click."+c.widgetName,function(){c.showTableColorDialog(this)});if(!d)return;try{e=d.rows;if(e.length>0)f=e[0].cells.length;else f=0;e=e.length}catch(g){}a("."+Gb+" input",b).val(e);a("."+xb+" input",b).val(f);a("."+Db+" input",b).val(d.getAttribute("width"));a("."+Bb+" input",b).val(d.getAttribute("height"));a("."+Ab+" input",b).val(d.getAttribute("border"));a("."+sb+" input",b).val(d.getAttribute("cellPadding"));a("."+tb+" input",b).val(d.getAttribute("cellSpacing"));a("."+F+" input",b).val(d.getAttribute("bgcolor")||"#ffffff");a("."+yb+" input",b).val(d.style.cssText)},submitEditTableDialog:function(){var j=this,c=j._getInspectElement(),d=a(c),b=j._getValuesFromTableDialog(),h=b&&f(b.rows),e=b&&f(b.cols),i,g;if(!b)return;if(c){d.attr("width",b.width);d.attr("height",b.height);d.attr("bgcolor",b.bgcolor);d.attr("border",b.border);d.attr("cellSpacing",b.cspacing);d.attr("cellPadding",b.cpadding);c.style.cssText=b.css;if(!h||isNaN(h))return;if(!e||isNaN(e))return;while(c.rows.length>h)c.deleteRow(0);while(c.rows.length<h){i=c.insertRow(0);while(i.cells.length<e){g=i.insertCell(0);g.innerHTML="&nbsp;"}}a.each(c.rows,function(b,a){while(a.cells.length>e)a.deleteCell(0);while(a.cells.length<e){g=a.insertCell(0);g.innerHTML="&nbsp;"}})}j._closeDialog()},_getValuesFromTableDialog:function(){var c=this,b=c.dialog,l=a("."+Gb+" input",b).val(),k=a("."+xb+" input",b).val(),j=a("."+Db+" input",b).val(),i=a("."+Bb+" input",b).val(),h=a("."+Ab+" input",b).val(),e=a("."+sb+" input",b).val(),g=a("."+tb+" input",b).val(),n=a("."+yb+" input",b).val(),m=a("."+F+" input",b).val();if(!c._isNumeric(l)){d("Please input a number for 'Rows' textbox.");return false}if(!c._isNumeric(k)){d("Please input a number for 'Columns' textbox.");return false}if(!c._isNumeric(j)){d("Please input a number for 'Table Width ' textbox.");return false}if(!c._isNumeric(i)){d("Please input a number for 'Table Height' textbox.");return false}if(!c._isNumeric(h)){d("Please input a number for 'Border thickness' textbox.");return false}if(!c._isNumeric(e)){d("Please input a number for 'Cell Padding' textbox.");return false}if(!c._isNumeric(g)){d("Please input a number for 'Cell Spacing' textbox.");return false}return{rows:l,cols:k,width:f(j),height:f(i),border:h,cpadding:e,cspacing:g,css:n,bgcolor:m}},showTableColorDialog:function(f){var b=this,c=b.subDialog,d=a(f).prev().val(),e=b._getDialogRes_Color();c.empty().append(e).wijdialog({width:"auto",height:"auto",modal:true,title:"Set Background Color",position:"center",resizable:false,captionButtons:{pin:{visible:false},refresh:{visible:false},toggle:{visible:false},minimize:{visible:false},maximize:{visible:false}}});c.delegate(bf,"click."+b.widgetName,function(){b.submitTableColorDialog()}).delegate(wb,"click."+b.widgetName,function(){b.closeSubDialog()});d!==""&&a("."+C+" input",c).val(d);a("."+zb,c).wijeditorcolorcanvas("."+C+" input",d);c.wijdialog("open")},submitTableColorDialog:function(){var b=this,c=b.subDialog,e=b.dialog,d=a("."+C+" input",c).val();a("."+F+" input:text",e).val(d);b.closeSubDialog()},closeSubDialog:function(){this.subDialog.wijdialog("close")},_getEditableTable:function(){var f=this,e,b,c;b=f._getSelectedElement();if(!b){d("Please select a table!");return false}c=a(b);if(c.is("td,tr,tbody"))b=c.parents("table:first")[0];else{e=c.find("table:only-child");if(a.browser.msie&&e.length)b=e[0];else{d("Please select a table!");return false}}Zb=b;return true},initPreviewDialog:function(){var a=this,b=a.dialog;a._setPreviewContent(0);b.delegate("#rad640_480","click."+a.widgetName,function(){a._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+a.widgetName,function(){a._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+a.widgetName,function(){a._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+a.widgetName,function(){a._splitPreviewPages(this.checked)}).delegate("."+Dc,"click."+a.widgetName,function(){a._printPreviewPage(true)}).delegate("."+Ec,"click."+a.widgetName,function(){a._printPreviewPage(false)}).delegate("."+Uc,"click."+a.widgetName,function(){a._closeDialog()}).delegate("."+Pc,"click."+a.widgetName,function(){a._navigatePreviewPage(false)}).delegate("."+Oc,"click."+a.widgetName,function(){a._navigatePreviewPage(true)})},_setPreviewContent:function(d){var b=this,f=b.dialog,g=a("iframe",f),e=a("."+qb+" span",f),c=g[0].contentWindow.document;c.open();if(d===-1){c.write(b._getPreviewAllPageContent());e.html("1 / 1")}else{c.write(b._getPreviewPageContent(d));e.html(d+1+" / "+b._getPreviewPageCount())}c.close()},_setPreviewDialogSize:function(g,f){var h=this,b=h.dialog,c=a("iframe",b),e=b.wijdialog("option","width"),d=b.wijdialog("option","height");if(e==="auto")e=b.parent(".wijmo-wijdialog").width()-c.width();else e=e-c.width();if(d==="auto")d=b.parent(".wijmo-wijdialog").height()-c.height();else d=d-c.height();c.css("width",g).css("height",f);b.wijdialog("option",{width:g+e,height:f+d})},_getPreviewPageCount:function(){return this._getPreviewPages().length},_getPreviewPageContent:function(a){var b=this._getPreviewPages();return b.length>a?b[a]:null},_getPreviewAllPageContent:function(){return this._getDesignViewText()},_getPreviewPages:function(){var b=this._getPreviewAllPageContent(),c=new RegExp("<(DIV|div)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>(.*?)<\\/(DIV|div)>","g"),a=b.replace(c,"!-~U^n#i@q,P|.a=g~e+br!");return a.split("!-~U^n#i@q,P|.a=g~e+br!")},_curPageIdx:0,_splitPreviewPages:function(f){var b=this,e=b.dialog,c=a("."+yc,e),d=a("."+qb,e);if(f){b._setPreviewContent(0);d.show();c.hide()}else{b._setPreviewContent(-1);d.hide();c.show()}b._curPageIdx=0},_navigatePreviewPage:function(f){var c=this,e=a("#chkSplit",c.dialog),b=c._curPageIdx,d=c._getPreviewPageCount();if(e.is(":checked")){if(f){b++;if(b<d)c._setPreviewContent(b);else b=d-1}else{b--;if(b>=0)c._setPreviewContent(b);else b=0}c._curPageIdx=b}},_printPreviewPage:function(f){var c=this,b=c.dialog,e=a("#chkSplit",b),d=a("iframe",b)[0].contentWindow;if(f){e.removeAttr("checked");c._setPreviewContent(-1)}d.focus();d.print()},initCleanUpDialog:function(){var b=this,c=b.dialog;a("textarea",c).val(b.sourceView.val());c.delegate(j,"click."+b.widgetName,function(){b.submitCleanUpDialog();b._onDesignViewBlur()}).delegate(p,"click."+b.widgetName,function(){b._closeDialog()})},submitCleanUpDialog:function(){var e=this,d=e.dialog,f=e.sourceView,b=f.val(),c;if(a("#replaceSpans",d).is(":checked")){c=new RegExp("<\\/?SPAN[^>]*>","g");b=b.replace(c,"")}if(a("#replaceClass",d).is(":checked")){c=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g");b=b.replace(c,"<$1$3")}if(a("#replaceStyle",d).is(":checked")){c=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g");b=b.replace(c,"<$1$3");c=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g");b=b.replace(c,"<$1$3");c=new RegExp("<\\\\?\\?xml[^>]*>","g");b=b.replace(c,"");c=new RegExp("<\\/?\\w+:[^>]*>","g");b=b.replace(c,"")}if(a("#replaceNbsp",d).is(":checked")){c=new RegExp("&nbsp;","g");b=b.replace(c," ")}if(a("#transformPtoDiv",d).is(":checked")){c=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g");b=b.replace(c,"<div$2</div>")}f.val(b);e._setDesignViewText(b);e._addtoUndoBuffer();e._closeDialog()},initFindDialog:function(){var a=this,b=a.dialog;if(a.tRange)a.tRange=null;b.delegate(j,"click."+a.widgetName,function(){a.submitFindAction()}).delegate(p,"click."+a.widgetName,function(){a.submitReplaceAction();a._onDesignViewBlur()})},submitFindAction:function(){var b=this,c=a("textarea:first",b.dialog).val();if(a.trim(c)==="")return;b._findAndReplaceString(c)},submitReplaceAction:function(){var f=this,e=f.dialog,b=a("textarea:first",e).val(),c=a("textarea:last",e).val();if(a.trim(b)==="")return;if(a.trim(c)===""){d("please input replace string");return}f._findAndReplaceString(b,c)},tRange:null,txtFoundInIE:false,txtFoundInNoneIE:false,_findAndReplaceString:function(e,f){var b=this,h=b._getDesignViewWindow(),c=0,g=false,i=f&&f!==e;if(!f)f=e;if(a.browser.msie){if(b.tRange)if(b.txtFoundInIE&&i){b.tRange.pasteHTML(f);b.tRange=null;g=true;b.txtFoundInIE=false}else{b.tRange.collapse(false);c=b.tRange.findText(e);c&&b.tRange.select()}if(!g&&(!b.tRange||!c)){b.tRange=h.document.body.createTextRange();c=b.tRange.findText(e);if(c){b.tRange.select();if(i){b.tRange.pasteHTML(f);b.tRange=null;g=true}}}}else{if(b.txtFoundInNoneIE&&i){b._replaceSelectionForNoneIE(f);g=true;b.txtFoundInNoneIE=false}else{c=h.find(e);if(!c){c=h.find(e,0,1);while(h.find(e,0,1))continue}}b.txtFoundInNoneIE=b.txtFoundInNoneIE||c;if(b.txtFoundInNoneIE&&i){b._replaceSelectionForNoneIE(f);g=true;b.txtFoundInNoneIE=false}}if(!c&&!g){d('"'+e+'" String Not Found');b.tRange=null;b.txtFoundInNoneIE=false;b.txtFoundInIE=false}else b.txtFoundInIE=true},_replaceSelectionForNoneIE:function(d){var a=this._getDesignViewDocument(),b="insert_html_"+Math.round(Math.random()*1e8),c=new RegExp("<[^<]*"+b+"[^>]*>");a.execCommand("insertimage",false,b);a.body.innerHTML=a.body.innerHTML.replace(c,d)},initMediaDialog:function(){var a=this,b=a.dialog;b.delegate(j,"click."+a.widgetName,function(){a.submitMediaDialog();a._onDesignViewBlur()}).delegate(p,"click."+a.widgetName,function(){a._closeDialog()})},submitMediaDialog:function(){var b=this,c=b.dialog,h=a("select",c).val(),e=a("."+Xc+" input",c).val(),g=a("."+Sc+" input",c).val(),f=a("."+Nc+" input",c).val();if(e===""){d("URL is empty!");return}if(!b._isUrl(e)){d("please input correct URL!");return}if(!b._isNumeric(g)){d("please input width of the media!");return}if(!b._isNumeric(f)){d("please input height of the media!");return}b._insertMedia(h,e,g,f);b._closeDialog()},_insertMedia:function(f,d,c,b){var e=this,a="";e._setIESelection();switch(f){case"video":a+='<embed src="'+d+'" width="'+c+'" height="'+b+'" type=audio/x-pn-realaudio-plugin console="Clip1" controls="IMAGEWINDOW,ControlPanel,StatusBar" autostart="true"></embed>';break;case"flash":a+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+c+'" height="'+b+'">';a+='<param name="movie" value="'+d+'">';a+='<param name="quality" value="high">';a+='<embed src="'+d+'" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="'+c+'" height="'+b+'"></embed>';a+="</object>";break;case"applet":a+='<applet code="'+d+'" width="'+c+'" height="'+b+'"></applet>';break;case"other":a+='<embed src="'+d+'" width="'+c+'" height="'+b+'"></embed>'}e.insertHTML(a)},initSpecialCharacterDialog:function(){var b=this,d=b.dialog,c=a("."+zc+" span",d);d.delegate("label","click."+b.widgetName,function(){b.submitSpecialCharacterDialog(this);b._onDesignViewBlur()}).delegate(j,"click."+b.widgetName,function(){b._closeDialog()}).delegate("label","mouseover."+b.widgetName,function(){c.html(a(this).html())}).delegate("label","mouseout."+b.widgetName,function(){c.empty()})},submitSpecialCharacterDialog:function(c){var b=this;b._setIESelection();b.insertHTML(a(c).html());b._closeDialog()},_setSaveBtnEnabled:function(){c.wijribbon(D,tc,false)},_undoAction:function(){var b=this._getDesignViewDocument().body,a={};i--;if(i<=0)i=0;b.innerHTML=A[i];if(!i){a[E]=true;a[I]=false;c.wijribbon(Eb,a)}else c.wijribbon(D,I,false)},_redoAction:function(){var d=this._getDesignViewDocument().body,b=A.length,a={};i++;if(i>=b-1)i=b-1;d.innerHTML=A[i];if(i===b-1){a[E]=false;a[I]=true;c.wijribbon(Eb,a)}else c.wijribbon(D,E,false)},_addtoUndoBuffer:function(){for(var b=A.length-1-i,a=0;a<b;a++)A.pop();i++;A.push(this._getDesignViewText());c.wijribbon(D,E,false)},_deleteSelectionContent:function(){var e=this._getDesignViewWindow(),b,c,d,f="rangeCount";if(a.browser.msie){b=e.document.selection;b.type.toLowerCase()!=="none"&&b.clear()}else{b=e.getSelection();for(c=0;c<b[f];c++){d=b.getRangeAt(c);d.deleteContents()}}},_refreshPathSelector:function(){var e=this,d=e._getParentElement(e._getDesignViewWindow()),c=e._getPathSelector(),f=a(d).parents(),h=f.length,g="wijmo-wijeditor-label ui-state-default ui-corner-all",b;if(!d)return;c.empty();for(b=h-1;b>=0;b--)c.append("<label class='"+g+"'>&lt;"+f[b].tagName.toLowerCase()+"&gt;</label>");c.append("<label class='"+g+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+d.tagName.toLowerCase()+"&gt;</label>")},_toggleTableBorders:function(){var c=this._getDesignViewDocument(),b=a("#__wijStyle",c);V=!V;if(a.browser.safari)if(V)b.html("table,td,tr{border: 1px #acacac dashed;}");else b.empty();else b.attr("disabled",!V)},_tableAction:function(j){var b=this,o=b._getParentElement(b._getDesignViewWindow()),k=a(o).closest("td"),l,n,q,f,c,h,g,i,m,p,e=0;b._setSaveBtnEnabled();if(k.length===0&&j!==N)return false;else if(j!==N){l=k.parent();n=l.closest("table");q=k[0];f=l[0];c=n[0];h=f.rowIndex;g=q.cellIndex}try{switch(j){case cc:i=f.cells.length;p=c.insertRow(h);for(e=0;e<i;e++)b._insertCell(p,e);break;case dc:c.deleteRow(h);break;case Jb:m=c.rows.length;for(e=0;e<m;e++)b._insertCell(c.rows[e],g);break;case Kb:b._removeColumn(c,g);break;case Vb:b._insertCell(f,g+1);break;case Xb:i=f.cells.length;if(i===1)c.deleteRow(h);else f.deleteCell(g);break;case ec:b._splitCell(c,f,h,g);break;case N:b._mergeCell(b._getSelectedCells(o))}this._addtoUndoBuffer()}catch(r){d(r.message);return false}return true},_removeColumn:function(e,h){var i=e.rows.length,f=0,g,c,a,b,d;while(f<i){g=e.rows[f];c=g.cells;a=c.length;b=h>a-1?a-1:h;d=c[b].colSpan;if(d>1&&a>1)if(b+1<a)c[b+1].colSpan+=d-1;else c[b-1].colSpan+=d+1;if(a===1){e.deleteRow(f);i=e.rows.length}else{g.deleteCell(b);f++}}},_splitCell:function(j,h,l,e){var k=j.rows.length,a=0,i=0,f,d,b,g,c;while(a<=e){if(h.cells[a].colSpan>1)i+=h.cells[a].colSpan-1;a++}this._insertCell(h,e+1);for(b=0;b<k;b++){f=j.rows[b];if(b!==l){g=e;a=0;d=0;while(a<=g){if(f.cells[a].colSpan>1){d+=f.cells[a].colSpan-1;g-=d}a++}c=e+i-d;if(c<0)c=0;f.cells[c].colSpan++}}},_mergeCell:function(b){var e=b.length,c,a,f,d;if(e<2||b[0].parentNode!==b[e-1].parentNode)return false;c=b[0].parentNode;a=b[0].cellIndex;f=a+e;for(d=a+1;d<f;d++){c.cells[a].innerHTML+=c.cells[a+1].innerHTML;c.cells[a].colSpan++;c.deleteCell(a+1)}},_getSelectedCells:function(k){var j=this._getDesignViewWindow(),m=j.document,e=[],b,d,h,c,f,g,i,l;if(a.browser.msie){b=m.selection.createRange();d=a(k).closest("tr")[0];d&&a.each(d.cells,function(f,d){var a=m.selection.createRange(),c="compareEndPoints";a.moveToElementText(d);(b.inRange(a)||b[c]("StartToStart",a)>=0&&b[c]("StartToEnd",a)<=0||b[c]("EndToStart",a)>=0&&b[c]("EndToEnd",a)<=0)&&e.push(d)})}else if(a.browser.mozilla){h=j.getSelection();f=h.rangeCount;for(c=0;c<f;c++){b=h.getRangeAt(c);g=b.startContainer;i=g.nodeName.toLowerCase();if(i==="td"||i==="th")e.push(g);else if(i==="tr"){l=b.startOffset;e.push(g.cells[l])}}}else{h=j.getSelection();d=a(k).closest("tr")[0];if(d){f=d.cells.length;for(c=0;c<f;c++)e.push(d.cells[c])}}return e},insertDateAndTime:function(){this.insertHTML((new Date).toDateString()+" "+(new Date).toTimeString())},_toggleWordWrap:function(){var d=this,b=d.sourceView,e="wrap",c;vc=!vc;c=vc?"soft":"off";b.attr(e,c);b[0].focus();if(a.browser.mozilla){b.hide();l.setTimeout(function(){b.show()},40)}},insertHTML:function(d){var c=this,e=c._getDesignViewDocument(),b;try{if(a.browser.msie){b=e.selection.createRange();b.pasteHTML(d);b.collapse(false);b.select()}else e.execCommand("insertHTML",false,d)}catch(f){}c._addtoUndoBuffer();c._setSaveBtnEnabled()},_getSelectedContent:function(){var g=this._getDesignViewWindow(),f=g.document,c="",d="cloneContents",a,e,b;if(!f.selection){a=g.getSelection().getRangeAt(0);if(a)if(a[d]){e=a[d]();b=document.createElement("div");b.appendChild(e);c=b.innerHTML;b=null}}else{a=f.selection.createRange();return a.htmlText}return c||""},_setIESelection:function(){a.browser.msie&&H&&H.select()},_setIEFocus:function(){var b=this._getDesignViewDocument();if(a.browser.msie)try{b.body.focus()}catch(c){}},focus:function(){var b=this._getDesignViewWindow(),c=b.document;if(a.browser.msie)if(!H)c.body.focus();else H.select();else b.focus()},_getInspectElement:function(){return Zb||this._getSelectedElement()},_getSelectedElement:function(){return this._getParentElement(this._getDesignViewWindow())},_createElement:function(c,a,b){return new gb(c,a,b)},_createDiv:function(a){return this._createElement("div",{"class":a})},_createSpan:function(a,b){var c=this;return!b?c._createElement("span",{"class":a}):a.length===0?c._createElement("span",b):this._createElement("span",b,{"class":a})},_createTextBox:function(c,b){var a={"class":c,type:"text"};if(b)a.value=b;return this._createElement("input",a)},_createLabel:function(b,a){return a?new gb("label",b,{"for":a}):new gb("label",b)},_createRadio:function(d,c,b){var a={name:c,id:d,value:b,type:"radio"};return this._createElement("input",a)},_createCheckbox:function(b){var a={type:"checkbox",id:b};return this._createElement("input","",a)},_createSelect:function(d,e){var c=this,f={"class":d},b=c._createElement("select",f);if(d==="")b=c._createElement("select");a.each(e,function(e,d){if(a.isPlainObject(d)&&d.selected)b.add(c._createElement("option",d.text,{selected:"selected"}));else b.add(c._createElement("option",d))});return b},_createInputButton:function(c,b){var a={"class":c,type:"button"};if(b)a.value=b;return this._createElement("input",a)},_createTextField:function(g,f,e,c){var b=this,a=b._createDiv(f),d={type:"text"};if(c)d.value=c;a.add(b._createSpan(h,g));a.add(b._createElement("input",d));e&&a.add(new Ff(e));return a},_createSeparator:function(){var b=this,a=b._createDiv(Gf);a.add(b._createElement("hr"));return a},_createOKCancelButtons:function(){var b=this,a=b._createDiv(v);a.add(b._createElement("input",{type:"button","class":m,value:"OK"}));a.add(b._createElement("input",{type:"button","class":m,value:"Cancel"}));return a},_getDialogRes_Template:function(){var a=this,b=a._createDiv(g),e=a._createDiv(Df),f=a._createDiv(tf),n=a._createDiv(Ef),l=a._createDiv(uf),i=a._createDiv(wf),j=a._createElement("div","Name :"),k=a._createElement("div","Description :"),c=a._createDiv(Cf),d=a._createDiv(sf);e.add(a._createElement("div","Select Template:",{"class":vf}));e.add(a._createElement("div","Template Preview:",{"class":xf}));b.add(e);n.add(a._createElement("select",{size:8}));l.add(a._createElement("iframe",{frameborder:0}));f.add(n);f.add(l);b.add(f);j.add(a._createSpan(Pb));k.add(a._createSpan(Tb));i.add(j);i.add(k);b.add(i);c.add(a._createSpan(h,"Name :"));c.add(a._createTextBox(M));c.add(a._createSpan(h,"Description :"));c.add(a._createTextBox(U));b.add(c);d.add(a._createInputButton(m+" "+hd,"Delete selected"));d.add(a._createInputButton(m+" "+pd,"Save current page as template"));b.add(d);b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_ImageBrowser:function(){var a=this,g=a._createDiv(k),c=a._createDiv(Je),b=a._createDiv(Te),d=a._createDiv(Mb),f=a._createDiv(hf),e=a._createDiv(Ke);b.add(a._createTextField("Image src:",Z));b.add(a._createTextField("Image alt text:",fd));b.add(a._createTextField("Image width:",Nb,"px"));b.add(a._createTextField("Image height:",Fb,"px"));b.add(a._createTextField("Css text:",gd));c.add(b);d.add(f);f.add(a._createElement("select",{size:8}));d.add(e);e.add(a._createElement("img",{src:"",alt:""}));c.add(d);c.add(a._createSeparator());c.add(a._createOKCancelButtons());g.add(c);return g.render()},_getDialogRes_Link:function(){var b=this,c=b._createDiv(z),n=b._createTextField("Address :",L),f=b._createDiv(Jc),e=b._createElement("div"),m=[{id:"radUrl",value:"url"},{id:"radAnchor",value:"anchor",checked:true},{id:"radMail",value:"email"}],i=[],o=b._createTextField("Text to display :",Ob),g=b._createDiv(R),l=b._createSpan(h,"Target :"),j=[{text:"_blank",selected:true},"_parent","_self","_top"],k=b._createSelect(R,j),p=b._createTextField("Css :",Sb),d;c.add(n);c.add(f);f.add(e);a.each(m,function(c,a){e.add(b._createRadio(a.id,"radioList",a.value));e.add(b._createLabel(a.value,a.id))});for(d=1;d<8;d++)i.push("#anchor"+d.toString());f.add(b._createSelect(Cb,i));c.add(b._createSeparator());c.add(o);c.add(g);g.add(l);g.add(k);c.add(p);c.add(b._createSeparator());c.add(b._createOKCancelButtons());return c.render()},_getDialogRes_TagInspector:function(){var a=this,b=a._createDiv(r),f=a._createDiv(oe),c=a._createDiv(Kd),e=a._createDiv(ne),d=a._createDiv(ub);b.add(f);f.add(a._createSpan(fe,"Selected tag:"));f.add(a._createSpan(Hc,""));b.add(c);c.add(a._createCheckbox("displayNoEmpty"));c.add(a._createLabel("Display not empty attributes only","displayNoEmpty"));b.add(e);e.add(a._createSpan(h,"Attributes:"));e.add(a._createDiv(Q));b.add(d);d.add(a._createSpan(h,"Inner HTML:"));d.add(a._createElement("textarea"));b.add(a._createTextField("Css Text:",Hb));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_Color:function(){return this._getDialogRes_CommonColor("#FFFFFF")},_getDialogRes_ForeColor:function(){return this._getDialogRes_CommonColor("#000000")},_getDialogRes_BackColor:function(){return this._getDialogRes_CommonColor("#FFFFFF")},_getDialogRes_CommonColor:function(d){var a=this,b=a._createDiv(ic),c=a._createDiv(C);b.add(a._createDiv(zb));b.add(c);c.add(a._createSpan(h,"Selected Color:"));c.add(a._createElement("input",{type:"text",value:d}));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_Table:function(){var a=this,b=a._createDiv(o),c=a._createDiv(F);b.add(a._createTextField("Rows :",Gb,"",3));b.add(a._createTextField("Columns :",xb,"",3));b.add(a._createTextField("Table Width :",Db,"&nbsp;pixels",200));b.add(a._createTextField("Table Height :",Bb,"&nbsp;pixels",200));b.add(a._createTextField("Border thickness :",Ab));b.add(a._createTextField("Cell Padding :",sb));b.add(a._createTextField("Cell Spacing :",tb));b.add(a._createTextField("Css Text :",yb));b.add(c);c.add(a._createSpan(h,"Background Color :"));c.add(a._createElement("input",{type:"text"}));c.add(a._createElement("input",{type:"button",value:"..."}));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_Preview:function(){var a=this,c=a._createDiv(n),b=a._createDiv(Wd),e=a._createDiv(v),d=a._createDiv(qb),f=a._createDiv(Gd);c.add(b);b.add(a._createSpan(h,"Preview Size:"));b.add(a._createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"}));b.add(a._createLabel("640x480","rad640_480"));b.add(a._createElement("input",{id:"rad800_600",name:"preview",type:"radio"}));b.add(a._createLabel("800x600","rad800_600"));b.add(a._createElement("input",{id:"rad1024_768",name:"preview",type:"radio"}));b.add(a._createLabel("1024x768","rad1024_768"));b.add(a._createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"}));b.add(a._createLabel("Split pages","chkSplit"));c.add(a._createSeparator());c.add(e);e.add(a._createInputButton(m+" "+Dc,"Print All"));e.add(a._createInputButton(m+" "+Ec,"Print Page"));e.add(a._createInputButton(m+" "+Uc,"OK"));c.add(a._createSeparator());c.add(d);d.add(a._createElement("a","Prev page",{"class":Pc,href:"#"}));d.add(a._createElement("span","1 / 1"));d.add(a._createElement("a","Next page",{"class":Oc,href:"#"}));c.add(a._createDiv(yc));c.add(f);f.add(a._createElement("iframe",{src:"about:blank"}));return c.render()},_getDialogRes_CleanUp:function(){var b=this,c=b._createDiv(Y),e=b._createDiv(Vd),f=b._createDiv(Nd),d=b._createDiv(Ud),g=[{id:"replaceSpans",label:"Strip SPAN tag"},{id:"replaceClass",label:"Strip CLASS tag"},{id:"replaceStyle",label:"Strip STYLE attribute"},{id:"replaceNbsp",label:"Replace &amp;nbsp; symbol"},{id:"transformPtoDiv",label:"Transform Paragraph to DIV"}];c.add(e);e.add(b._createSpan(h,"Document source :"));c.add(f);f.add(b._createElement("textarea",{readonly:"readonly"}));c.add(d);a.each(g,function(c,a){d.add(b._createCheckbox(a.id));d.add(b._createLabel(a.label,a.id))});c.add(b._createSeparator());c.add(b._createOKCancelButtons());return c.render()},_getDialogRes_FindAndReplace:function(){var a=this,b=a._createDiv(lc),e=a._createDiv(cf),d=a._createDiv(Be),c=a._createDiv(v);b.add(e);e.add(a._createSpan(h,"Find:"));e.add(a._createElement("textarea","text"));b.add(d);d.add(a._createSpan(h,"Replace:"));d.add(a._createElement("textarea"));b.add(a._createSeparator());b.add(c);c.add(a._createInputButton(m,"Find"));c.add(a._createInputButton(m,"Replace"));return b.render()},_getDialogRes_Media:function(){var a=this,b=a._createDiv(P),c=a._createDiv(Ue);b.add(c);c.add(a._createSpan(h,"Media Type :"));c.add(a._createSelect("",["flash","video","applet","other"]));b.add(a._createTextField("Media Url :",Xc));b.add(a._createTextField("Width :",Sc,"px",200));b.add(a._createTextField("Height :",Nc,"px",200));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_SpecialCharacter:function(){var b=this,c=b._createDiv(q),e=b._createDiv(Md),n=b._createDiv(Id),l=b._createDiv(zc),d=b._createDiv(Td),f=b._createDiv(rb,"Punctuation"),i=b._createDiv(Ed),p=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],h=b._createDiv(rb,"Symbols"),o=b._createDiv(Jd),s=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],g=b._createDiv(rb,"Diacritics"),j=b._createDiv(Fd),r=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],k=b._createDiv(v);c.add(e);e.add(n);n.add(l);l.add(new gb("span"));e.add(d);d.add(f);f.add(i);a.each(p,function(c,a){i.add(b._createLabel(a))});d.add(h);h.add(o);a.each(s,function(c,a){o.add(b._createLabel(a))});d.add(g);g.add(j);a.each(r,function(c,a){j.add(b._createLabel(a))});c.add(b._createSeparator());k.add(b._createInputButton(m,"Cancel"));c.add(k);return c.render()},_copyFromClipboard:function(){var d,c,b={},e={};if(l.clipboardData)return l.clipboardData.getData("Text");else if(a.browser.mozilla){try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(f){}d=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);if(!d)return false;c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return false;c.addDataFlavor("text/unicode");d.getData(c,d.kGlobalClipboard);c.getTransferData("text/unicode",b,e);if(b)b=b.value.QueryInterface(Components.interfaces.nsISupportsString);return b?b.data.substring(0,e.value/2):""}},_copyToClipboard:function(e){var f,c,g,b={},h={};if(l.clipboardData&&e)l.clipboardData.setData("Text",e);else if(a.browser.mozilla)try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");f=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!f)return;c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return;c.addDataFlavor("text/unicode");b={};h={};b=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);b.data=e;c.setTransferData("text/unicode",b,e.length*2);g=Components.interfaces.nsIClipboard;if(!f)return false;f.setData(c,null,g.kGlobalClipboard)}catch(i){b="Copy text to Clipboard \n";b+="If you are using firefox please do the following :\n ";b+="1. Write in your url box : 'about:config'\n";b+="2. Change signed.applets.codebase_principal_support = true\n";d(b)}},fixAbsoluteUrlsIfNeeded:function(o){for(var g=this,n=xc.URL,b=xc.URL,f=xc.URL,i=false,p=b.length,a=o,d,j,k,c,l,m,h,e=p-1;e>0;e--){d=b.charAt(e);j=b.charAt(e-1);if(d==="/"||d==="\\"){if(d===j)break;f=b.substring(0,e)+d;if(!i){b=f;i=true}}}k=g._prepareLiteralRegexText(n+"?");c=new RegExp(k,"g");a=a.replace(c,"?");l=g._prepareLiteralRegexText(b);c=new RegExp(l,"g");a=a.replace(c,"");m=g._prepareLiteralRegexText(f);c=new RegExp(m,"g");a=a.replace(c,"/");h=a.indexOf("#");if(h>-1)a=a.substr(h);return a},_insertCell:function(c,b){var a=c.insertCell(b);a.innerHTML="&nbsp;";return a},_getDictionaryDeclare:function(){var a={};a.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"];a.b=["class","dir","id","lang","title"];a.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"];a.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"];a.code=["class","dir","id","lang","title"];a.div=["align","class","dir","id","lang","title"];a.em=["class","dir","id","lang","title"];a.font=["class","color","dir","face","id","lang","pointsize","size","title"];a.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"];a.hr=["align","class","color","id","noshade","size","title","width"];a.i=["class","dir","id","lang","title"];a.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"];a.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"];a.label=["accesskey","class","dir","for","id","lang","title"];a.li=["class","dir","id","lang","title","type","value"];a.ol=["class","compact","dir","id","lang","start","title","type"];a.option=["class","dir","disabled","id","label","lang","selected","title","value"];a.p=["align","class","dir","id","lang","title"];a.span=["class","dir","id","lang","title"];a.strong=["class","dir","id","lang","title"];a.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"];a.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"];a.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"];a.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"];a.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"];a.tbody=["align","bgColor","class","dir","id","lang","title","valign"];a.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"];a.u=["class","id","xml:lang"];a.ul=["class","compact","dir","id","lang","title","type"];return a},_getParentElement:function(e){var h=this,a=h._getRange(e),b,f,g,c,d;if(!a)return null;if(a.commonAncestorContainer){b=e.getSelection();f=a.startContainer||b.baseNode;g=a.endContainer||b.extentNode;c=a.startOffset;if(c===null)c=b.baseOffset;d=a.endOffset;if(d===null)d=b.extentOffset;return f===g&&d-c===1?b.anchorNode.childNodes[b.anchorOffset]:!a.commonAncestorContainer.tagName?e.document===a.commonAncestorContainer&&b.baseNode?b.baseNode.parentNode:a.commonAncestorContainer.parentNode:a.commonAncestorContainer}return a.length?a.item(0):a.parentElement?a.parentElement():null},_getRange:function(a){var b,c;if(a.document.selection&&!l.opera)return a.document.selection.createRange();if(a.getSelection){b=a.getSelection();if(!b||b.rangeCount<1)return null;if(b.getRangeAt)c=b.getRangeAt(0);else c=a.document.createRange();return c}},_generateUniqueName:function(b){var a=Ad[b];if(!a)a=0;Ad[b]=++a;return b+a},_setContentEditable:function(b,d){var c="designMode",e="contentEditable";try{if(b.body[e])b.body[e]=d.toString();if(b[c])if(!d&&b[c]!=="off")b[c]="off";else if(d&&b[c]!=="on")b[c]="on";d&&!a.browser.msie&&b.execCommand("useCSS",false,true)}catch(f){}},_formatString:function(a,d){for(var c=a.length,b=0;b<d-c;b++)a="0"+a;return a},_convertToWebColor:function(c,b,a){var d=this,i,h,g,e;if(isNaN(c)||255-c<0)c=0;if(isNaN(b)||255-b<0)b=0;if(isNaN(a)||255-a<0)a=0;i=d._formatString(f(c).toString(16),2);h=d._formatString(f(b).toString(16),2);g=d._formatString(f(a).toString(16),2);e="#"+i+h+g;return e},_prepareLiteralRegexText:function(b){var a=b;a=a.replace("\\","\\\\");a=a.replace(".","\\.");a=a.replace("?","\\?");return a},_isNumeric:function(a){return new RegExp("^\\d+$").test(a)},_isEmail:function(a){return new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+").test(a)},_isUrl:function(a){return new RegExp("[a-zA-z]+://[^s]+").test(a)},refresh:function(){var a=this,d=a.element,g=a._getHeader(),f=a._getFooter(),i=d.width(),h=d.height(),e=a._getContent(),b;a.editor.width(i).height(h);c.wijribbon("updateRibbonSize");b=a.editor.height()-g.outerHeight(true)-f.outerHeight(true);e.height(b).wijsplitter("refresh")},getText:function(){var a=this;return a._getDesignViewText()},setText:function(a){var b=this;a&&b._setDesignViewText(a)}})})(jQuery);(function(a){"use strict";var d=document,b=parseInt,c="wijmo-wijeditor",e=c+"-colorcanvas",g=c+"-color",h=c+"-wheel",i=c+"-overlay",f=c+"-marker";a.fn.wijeditorcolorcanvas=function(c,b){a.wijeditorcolorcanvas(this,c,b);return this};a.wijeditorcolorcanvas=function(c,e,d){var b=a(c).get(0);return b.wijeditorcolorcanvas||(b.wijeditorcolorcanvas=new a._wijeditorcolorcanvas(b,e,d))};a._wijeditorcolorcanvas=function(l,n,o){var c=this,j="",k,m;m="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ";j+="<div class='"+e+"'>";j+="<div class='"+g+"'></div>";j+="<div class='"+h+"'></div>";j+="<div class='"+i+"'></div>";j+="<div class='h-marker "+f+"'></div>";j+="<div class='sl-marker "+f+"'></div></div>";a(l).html(j);k=a("."+e,l);c.wheel=a("."+h,l).get(0);c.radius=84;c.square=100;c.width=194;a.browser.msie&&a.browser.version<7&&a("*",k).each(function(){var c=this,b=c.currentStyle.backgroundImage;if(b!=="none"){b=b.substring(5,b.length-2);a(c).css({backgroundImage:"none",filter:m+"src='"+b+"')"})}});c.linkTo=function(b){typeof c.callback==="object"&&a(c.callback).unbind("keyup",c.updateValue);c.color=null;if(typeof b==="function")c.callback=b;else if(typeof b==="object"||typeof b==="string"){c.callback=a(b);c.callback.bind("keyup",c.updateValue);c.callback.get(0).value&&c.setColor(c.callback.get(0).value)}return this};c.updateValue=function(){var a=this;a.value&&a.value!==c.color&&c.setColor(a.value)};c.setColor=function(a){var b=c.unpack(a);if(c.color!==a&&b){c.color=a;c.rgb=b;c.hsl=c.RGBToHSL(c.rgb);c.updateDisplay()}return this};c.setHSL=function(a){c.hsl=a;c.rgb=c.HSLToRGB(a);c.color=c.pack(c.rgb);c.updateDisplay();return this};c.widgetCoords=function(b){var f,g,h,e,d;h=b.target||b.srcElement;e=c.wheel;d=c.absolutePosition(e);f=(b.pageX||0*(b.clientX+a("html").get(0).scrollLeft))-d.x;g=(b.pageY||0*(b.clientY+a("html").get(0).scrollTop))-d.y;return{x:f-c.width/2,y:g-c.width/2}};c.mousedown=function(b){if(!d.dragging){a(d).bind("mousemove",c.mousemove).bind("mouseup",c.mouseup);d.dragging=true}var e=c.widgetCoords(b);c.circleDrag=Math.max(Math.abs(e.x),Math.abs(e.y))*2>c.square;c.mousemove(b);return false};c.mousemove=function(f){var b=c.widgetCoords(f),a,e,d;if(c.circleDrag){a=Math.atan2(b.x,-b.y)/6.28;if(a<0)a+=1;c.setHSL([a,c.hsl[1],c.hsl[2]])}else{e=Math.max(0,Math.min(1,-(b.x/c.square)+.5));d=Math.max(0,Math.min(1,-(b.y/c.square)+.5));c.setHSL([c.hsl[0],e,d])}return false};c.mouseup=function(){a(d).unbind("mousemove",c.mousemove).unbind("mouseup",c.mouseup);d.dragging=false};c.updateDisplay=function(){var d=c.hsl[0]*6.28,b;a(".h-marker",k).css({left:Math.round(Math.sin(d)*c.radius+c.width/2)+"px",top:Math.round(-Math.cos(d)*c.radius+c.width/2)+"px"});a(".sl-marker",k).css({left:Math.round(c.square*(.5-c.hsl[1])+c.width/2)+"px",top:Math.round(c.square*(.5-c.hsl[2])+c.width/2)+"px"});a("."+g,k).css("backgroundColor",c.pack(c.HSLToRGB([c.hsl[0],1,.5])));if(typeof c.callback==="object"){a(c.callback).css({backgroundColor:c.color,color:c.hsl[2]>.5?"#000":"#fff"});a(c.callback).each(function(){b=this;if(b.value&&b.value!==c.color)b.value=c.color})}else typeof c.callback==="function"&&c.callback.call(c,c.color)};c.absolutePosition=function(a){var d={x:a.offsetLeft,y:a.offsetTop},b;if(a.offsetParent){b=c.absolutePosition(a.offsetParent);d.x+=b.x;d.y+=b.y}return d};c.pack=function(a){var d=Math.round(a[0]*255),c,b;c=Math.round(a[1]*255);b=Math.round(a[2]*255);return"#"+(d<16?"0":"")+d.toString(16)+(c<16?"0":"")+c.toString(16)+(b<16?"0":"")+b.toString(16)};c.unpack=function(a){return a.length===7?[b("0x"+a.substring(1,3))/255,b("0x"+a.substring(3,5))/255,b("0x"+a.substring(5,7))/255]:a.length===4?[b("0x"+a.substring(1,2))/15,b("0x"+a.substring(2,3))/15,b("0x"+a.substring(3,4))/15]:void 0};c.HSLToRGB=function(g){var c,b,d,e,a,f=this;d=g[0];e=g[1];a=g[2];b=a<=.5?a*(e+1):a+e-a*e;c=a*2-b;return[f.hueToRGB(c,b,d+.33333),f.hueToRGB(c,b,d),f.hueToRGB(c,b,d-.33333)]};c.hueToRGB=function(b,c,a){a=a<0?a+1:a>1?a-1:a;return a*6<1?b+(c-b)*a*6:a*2<1?c:a*3<2?b+(c-b)*(.66666-a)*6:b};c.RGBToHSL=function(i){var h,a,f,g,j,d,e,c,b;e=i[0];c=i[1];b=i[2];h=Math.min(e,Math.min(c,b));a=Math.max(e,Math.max(c,b));f=a-h;d=(h+a)/2;j=0;if(d>0&&d<1)j=f/(d<.5?2*d:2-2*d);g=0;if(f>0){if(a===e&&a!==c)g+=(c-b)/f;if(a===c&&a!==b)g+=2+(b-e)/f;if(a===b&&a!==e)g+=4+(e-c)/f;g/=6}return[g,j,d]};a("*",k).mousedown(c.mousedown);c.setColor(o||"#000000");n&&c.linkTo(n)}})(jQuery);